

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>6. Logistic regression &#8212; Near or far</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'probability';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="5. All Data – New map data" href="hex-3000-m.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="titlepage.html">
  
  
  
  
  
    <p class="title logo__title">Near or far</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="bielersee_results.html">1. Bielersee</a></li>
<li class="toctree-l1"><a class="reference internal" href="lac_leman.html">2. Lac Léman</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_results.html">3. All Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="consider_distance_to_river.html">4. River discharge and lake intersections</a></li>
<li class="toctree-l1"><a class="reference internal" href="hex-3000-m.html">5. All Data – New map data</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">6. Logistic regression</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hammerdirt-analyst/landuse" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hammerdirt-analyst/landuse/issues/new?title=Issue%20on%20page%20%2Fprobability.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Logistic regression</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-chance-of-exceeding-the-median">6.1. What is the chance of exceeding the median?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#infrastructure">6.1.1. Infrastructure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#urbanization">6.1.2. Urbanization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forest">6.1.3. Forest</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#undefined">6.1.4. Undefined</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recreation">6.1.5. Recreation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-to-river-intersection">6.1.6. Distance to river intersection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#length-of-river-intersects">6.1.7. Length of river intersects</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tex2jax_ignore mathjax_ignore section" id="logistic-regression">
<h1><span class="section-number">6. </span>Logistic regression<a class="headerlink" href="#logistic-regression" title="Permalink to this headline">#</a></h1>
<p>Logistic regression is used to test the probability that a threshold value will be exceeded given the land-use configuration within a hex of 3 000 m. The distance to intersection and intersection length are also considered.</p>
<p>Recall that logisitic regression is often used for classification and predictive analytics. Logistic regression estimates the probability of an event occurring, such as exceeded threshhold or not, based on a given dataset of independent variables. Since the outcome is a probability, the dependent variable is bounded between 0 and 1. In logistic regression, a logit transformation is applied on the odds—that is, the probability of success divided by the probability of failure. This is also commonly known as the log odds, or the natural logarithm of odds.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark
<span class="c1"># sys, file and nav packages:</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">listdir</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">join</span>
<span class="kn">import</span> <span class="nn">typing</span>

<span class="c1"># math packages:</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">statsmodels.distributions.empirical_distribution</span> <span class="kn">import</span> <span class="n">ECDF</span>

<span class="c1"># charting:</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">ticker</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">IPython</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span> <span class="k">as</span> <span class="n">PILImage</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span> <span class="k">as</span> <span class="n">md</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="kn">import</span> <span class="nn">resources.landuse_config</span> <span class="k">as</span> <span class="nn">luse</span>

<span class="kn">import</span> <span class="nn">time</span>


<span class="c1"># survey data:</span>
<span class="n">dfx</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;resources/checked_sdata_eos_2020_21.csv&#39;</span><span class="p">)</span>


<span class="n">dfBeaches</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;resources/beaches.csv&quot;</span><span class="p">)</span>
<span class="n">dfCodes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;resources/codes_with_group_names_2015.csv&quot;</span><span class="p">)</span>

<span class="c1"># set the index of the beach data to location slug</span>
<span class="n">dfBeaches</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;location&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># set the index of to codes</span>
<span class="n">dfCodes</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># code description map</span>
<span class="n">code_d_map</span> <span class="o">=</span> <span class="n">dfCodes</span><span class="o">.</span><span class="n">description</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="c1"># shorten the descriptions of two codes</span>
<span class="n">code_d_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;G38&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;sheeting for protecting large cargo items&quot;</span>
<span class="n">code_d_map</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;G73&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Foamed items &amp; pieces (non packaging/insulation)&quot;</span>

<span class="c1"># code material map</span>
<span class="n">code_m_map</span> <span class="o">=</span> <span class="n">dfCodes</span><span class="o">.</span><span class="n">material</span>

<span class="c1"># this defines the css rules for the note-book table displays</span>
<span class="n">header_row</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;th:nth-child(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;background-color: #FFF; text-align:right&#39;</span><span class="p">}</span>
<span class="n">even_rows</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s1">&#39;tr:nth-child(even)&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;background-color: rgba(139, 69, 19, 0.08);&#39;</span><span class="p">}</span>
<span class="n">odd_rows</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;tr:nth-child(odd)&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="s1">&#39;background: #FFF;&#39;</span><span class="p">}</span>
<span class="n">table_font</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;tr&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="s1">&#39;font-size: 12px;&#39;</span><span class="p">}</span>
<span class="n">table_data</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;td&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="s1">&#39;padding: 6px;&#39;</span><span class="p">}</span>
<span class="n">table_css_styles</span> <span class="o">=</span> <span class="p">[</span><span class="n">even_rows</span><span class="p">,</span> <span class="n">odd_rows</span><span class="p">,</span> <span class="n">table_font</span><span class="p">,</span> <span class="n">header_row</span><span class="p">]</span>

<span class="n">pdtype</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>
<span class="n">pstype</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">diverging_palette</span><span class="p">(</span><span class="mi">230</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="n">as_cmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;resources/surveys_iqaasl.csv&#39;</span><span class="p">)</span>

<span class="c1"># the name of the lake was changed in the revision</span>

<span class="c1"># the lakes of interest</span>
<span class="c1"># collection points would be a good</span>
<span class="c1"># label. This is how they are considered in the model</span>
<span class="c1"># these locations serve as the endpoint for many </span>
<span class="c1"># small rivers</span>
<span class="n">collection_points</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;zurichsee&#39;</span><span class="p">,</span>
    <span class="s1">&#39;bielersee&#39;</span><span class="p">,</span>
    <span class="s1">&#39;neuenburgersee&#39;</span><span class="p">,</span>
    <span class="s1">&#39;walensee&#39;</span><span class="p">,</span>
    <span class="s1">&#39;vierwaldstattersee&#39;</span><span class="p">,</span>
    <span class="s1">&#39;brienzersee&#39;</span><span class="p">,</span>
    <span class="s1">&#39;thunersee&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lac-leman&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lago-maggiore&#39;</span><span class="p">,</span>
    <span class="s1">&#39;lago-di-lugano&#39;</span><span class="p">,</span>
    <span class="s1">&#39;zugersee&#39;</span>
<span class="p">]</span>

<span class="c1"># the data-frame of survey results to be considered</span>
<span class="n">features_of_interest</span> <span class="o">=</span> <span class="n">collection_points</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">feature</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">features_of_interest</span><span class="p">)]</span>

<span class="c1"># test the survey results of an object of interest</span>
<span class="c1"># against a threshhold</span>
<span class="n">code</span> <span class="o">=</span> <span class="s2">&quot;Gfrags&quot;</span>
<span class="n">to_test</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="n">code</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">threshhold</span> <span class="o">=</span> <span class="n">to_test</span><span class="o">.</span><span class="n">pcs_m</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>

<span class="c1"># map the location to the name of the lake</span>
<span class="n">wn_map</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;feature&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span>
<span class="n">wn_map</span> <span class="o">=</span> <span class="n">wn_map</span><span class="p">[</span><span class="s2">&quot;feature&quot;</span><span class="p">]</span>


<span class="c1"># The summary of the survey data</span>
<span class="n">locations</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">samples</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc_date</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">lakes</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">w_t</span> <span class="o">==</span> <span class="s2">&quot;l&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="s2">&quot;loc_date&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">w_t</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">codes_identified</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">codes_possible</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">total_id</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">data_summary</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;n locations&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">),</span>
    <span class="s2">&quot;n samples&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">samples</span><span class="p">),</span>
    <span class="s2">&quot;n lake samples&quot;</span><span class="p">:</span> <span class="n">lakes</span><span class="p">,</span>
    <span class="s2">&quot;n identified object types&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">codes_identified</span><span class="p">),</span>
    <span class="s2">&quot;n possible object types&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">codes_possible</span><span class="p">),</span>
    <span class="s2">&quot;total number of objects&quot;</span><span class="p">:</span> <span class="n">total_id</span>
<span class="p">}</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="n">data_summary</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">data</span><span class="o">=</span><span class="n">data_summary</span><span class="o">.</span><span class="n">values</span><span class="p">())</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span><span class="n">table_css_styles</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_128dd tr:nth-child(even) {
  background-color: rgba(139, 69, 19, 0.08);
}
#T_128dd tr:nth-child(odd) {
  background: #FFF;
}
#T_128dd tr {
  font-size: 12px;
}
#T_128dd th:nth-child(1) {
  background-color: #FFF;
  text-align: right;
}
</style>
<table id="T_128dd">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_128dd_level0_col0" class="col_heading level0 col0" >0</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_128dd_level0_row0" class="row_heading level0 row0" >n locations</th>
      <td id="T_128dd_row0_col0" class="data row0 col0" >93</td>
    </tr>
    <tr>
      <th id="T_128dd_level0_row1" class="row_heading level0 row1" >n samples</th>
      <td id="T_128dd_row1_col0" class="data row1 col0" >331</td>
    </tr>
    <tr>
      <th id="T_128dd_level0_row2" class="row_heading level0 row2" >n lake samples</th>
      <td id="T_128dd_row2_col0" class="data row2 col0" >331</td>
    </tr>
    <tr>
      <th id="T_128dd_level0_row3" class="row_heading level0 row3" >n identified object types</th>
      <td id="T_128dd_row3_col0" class="data row3 col0" >205</td>
    </tr>
    <tr>
      <th id="T_128dd_level0_row4" class="row_heading level0 row4" >n possible object types</th>
      <td id="T_128dd_row4_col0" class="data row4 col0" >230</td>
    </tr>
    <tr>
      <th id="T_128dd_level0_row5" class="row_heading level0 row5" >total number of objects</th>
      <td id="T_128dd_row5_col0" class="data row5 col0" >52269</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">my_path</span><span class="o">=</span>  <span class="s2">&quot;resources/hex-3000m-cleaned&quot;</span>

<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;river_bass&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;city&quot;</span><span class="p">,</span>
    <span class="s2">&quot;feature&quot;</span>
<span class="p">]</span>

<span class="n">column_rename</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;undefined&quot;</span><span class="p">:</span><span class="s2">&quot;Undefined&quot;</span><span class="p">}</span>
<span class="n">area_of_a_hex</span> <span class="o">=</span> <span class="mi">5845672</span>
<span class="n">id_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;OBJVAL&quot;</span><span class="p">]</span>
<span class="n">agg_val</span> <span class="o">=</span> <span class="s2">&quot;surface&quot;</span>

<span class="n">data_map_name</span> <span class="o">=</span> <span class="s2">&quot;lake-locations-landcover&quot;</span>

<span class="n">lc_groups</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Siedl&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Undefined&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Wald&#39;</span>
<span class="p">]</span>

<span class="n">lc_presence</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Obstanlage&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Reben&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Stadtzentr&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Sumpf&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Fels&#39;</span>
<span class="p">]</span>

<span class="n">groups_and_presence</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">lc_groups</span><span class="p">,</span> <span class="o">*</span><span class="n">lc_presence</span><span class="p">]</span>
       
<span class="n">merge_column</span> <span class="o">=</span> <span class="n">gby_column</span> <span class="o">=</span> <span class="s2">&quot;location&quot;</span>
<span class="n">merge_method</span> <span class="o">=</span> <span class="s1">&#39;outer&#39;</span>
<span class="n">merge_validate</span> <span class="o">=</span> <span class="s2">&quot;many_to_one&quot;</span>
<span class="n">quantiles</span> <span class="o">=</span>   <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mf">.9</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        
<span class="c1"># label the region of interest</span>
<span class="c1"># this creates a hierarcal group of the locations</span>
<span class="c1"># that are within a region. The most common would be lake</span>
<span class="n">regional_label</span> <span class="o">=</span> <span class="s2">&quot;lake&quot;</span>
<span class="n">label_map</span> <span class="o">=</span> <span class="n">wn_map</span>

<span class="c1"># collect the data</span>
<span class="n">data_map</span> <span class="o">=</span> <span class="n">luse</span><span class="o">.</span><span class="n">collect_feature_data</span><span class="p">(</span><span class="n">path_to_data</span><span class="o">=</span><span class="n">my_path</span><span class="p">)</span>
<span class="n">land_cover_data</span> <span class="o">=</span> <span class="n">data_map</span><span class="p">[</span><span class="n">data_map_name</span><span class="p">]</span>
<span class="n">land_cover_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">column_rename</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># limit the data to the parameters of interest</span>
<span class="n">land_use_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;data_map&quot;</span><span class="p">:</span><span class="n">land_cover_data</span><span class="p">,</span>
    <span class="s2">&quot;locations&quot;</span><span class="p">:</span><span class="n">locations</span><span class="p">,</span>
    <span class="s2">&quot;region&quot;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s2">&quot;columns&quot;</span><span class="p">:</span><span class="n">columns</span><span class="p">,</span>
    <span class="s2">&quot;id_vals&quot;</span><span class="p">:</span> <span class="n">id_vals</span><span class="p">,</span>
    <span class="s2">&quot;dim_oi&quot;</span><span class="p">:</span> <span class="n">area_of_a_hex</span><span class="p">,</span>
    <span class="s2">&quot;to_aggregate&quot;</span><span class="p">:</span><span class="n">agg_val</span><span class="p">,</span>
    <span class="s2">&quot;land_use_groups&quot;</span><span class="p">:</span><span class="n">lc_groups</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">test_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;df&quot;</span><span class="p">:</span><span class="n">to_test</span><span class="p">,</span>
    <span class="s2">&quot;threshhold&quot;</span><span class="p">:</span><span class="n">threshhold</span><span class="p">,</span>
    <span class="s2">&quot;merge_column&quot;</span><span class="p">:</span><span class="n">merge_column</span><span class="p">,</span>
    <span class="s2">&quot;merge_method&quot;</span><span class="p">:</span><span class="n">merge_method</span><span class="p">,</span>
    <span class="s2">&quot;merge_validate&quot;</span><span class="p">:</span><span class="n">merge_validate</span><span class="p">,</span>
    <span class="s2">&quot;groups&quot;</span><span class="p">:</span><span class="n">lc_groups</span><span class="p">,</span>
    <span class="s2">&quot;presence&quot;</span><span class="p">:</span><span class="n">lc_presence</span><span class="p">,</span>
    <span class="s2">&quot;quantiles&quot;</span><span class="p">:</span><span class="n">quantiles</span>
<span class="p">}</span>

<span class="n">inf_operation</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;k&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">,</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span><span class="s2">&quot;sum&quot;</span><span class="p">}</span>

<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;land_use_kwargs&#39;</span><span class="p">:</span> <span class="n">land_use_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;test_kwargs&#39;</span><span class="p">:</span> <span class="n">test_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;assign_undefined&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;cover&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;inf_operation&#39;</span><span class="p">:</span> <span class="n">inf_operation</span><span class="p">,</span>
    <span class="s1">&#39;regional_label&#39;</span><span class="p">:</span> <span class="n">regional_label</span><span class="p">,</span>
    <span class="s1">&#39;label_map&#39;</span><span class="p">:</span> <span class="n">label_map</span><span class="p">,</span>
    <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="kc">False</span>
<span class="p">}</span>


<span class="n">nx</span> <span class="o">=</span> <span class="n">luse</span><span class="o">.</span><span class="n">LanduseConfiguration</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">nx</span><span class="o">.</span><span class="n">groups_and_presence</span><span class="p">()</span>
<span class="n">nx</span><span class="o">.</span><span class="n">inference_groups</span><span class="p">()</span>
<span class="n">nxf</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">grouped_data</span>
<span class="n">nx_conf</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">labeled_groups</span>

<span class="c1"># add the data from another land use layer</span>
<span class="c1"># the results will be added to the landcover data frame</span>
<span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;strasse&quot;</span>
<span class="n">data_map_name</span> <span class="o">=</span> <span class="s1">&#39;lake-locations-strasse&#39;</span>
<span class="n">id_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;OBJEKTART&quot;</span><span class="p">]</span>
<span class="n">agg_val</span> <span class="o">=</span> <span class="s2">&quot;length&quot;</span>

<span class="c1"># identify the columns of interest</span>
<span class="n">st_groups</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;10m Strasse&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1m Weg&#39;</span><span class="p">,</span>
    <span class="s1">&#39;1m Wegfragment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;2m Weg&#39;</span><span class="p">,</span>
    <span class="s1">&#39;2m Wegfragment&#39;</span><span class="p">,</span>
    <span class="s1">&#39;3m Strasse&#39;</span><span class="p">,</span>
    <span class="s1">&#39;4m Strasse&#39;</span><span class="p">,</span>
    <span class="s1">&#39;6m Strasse&#39;</span><span class="p">,</span>
    <span class="s1">&#39;8m Strasse&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Ausfahrt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Autobahn&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Autostrasse&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Dienstzufahrt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Einfahrt&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Faehre&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Markierte Spur&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Platz&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Raststaette&#39;</span><span class="p">,</span> <span class="s1">&#39;Verbindung&#39;</span><span class="p">,</span> <span class="s1">&#39;Zufahrt&#39;</span>
<span class="p">]</span>

<span class="n">st_presence</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">groups_and_presence</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">st_groups</span><span class="p">,</span> <span class="o">*</span><span class="n">st_presence</span><span class="p">]</span>

<span class="c1"># collect the data</span>
<span class="n">street_lengths_data</span> <span class="o">=</span> <span class="n">data_map</span><span class="p">[</span><span class="n">data_map_name</span><span class="p">]</span>

<span class="c1"># update the key word arguments for the land use data</span>
<span class="n">land_use_update</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data_map</span><span class="o">=</span><span class="n">street_lengths_data</span><span class="p">,</span> <span class="n">id_vals</span><span class="o">=</span><span class="n">id_vals</span><span class="p">,</span> <span class="n">to_aggregate</span><span class="o">=</span><span class="n">agg_val</span><span class="p">,</span> <span class="n">land_use_groups</span><span class="o">=</span><span class="n">st_groups</span><span class="p">)</span>
<span class="n">land_use_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">land_use_update</span><span class="p">)</span>

<span class="c1"># update the key word arguments for the test data</span>
<span class="n">test_update</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">st_groups</span><span class="p">,</span> <span class="n">presence</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">test_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">test_update</span><span class="p">)</span>

<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;land_use_kwargs&#39;</span><span class="p">:</span> <span class="n">land_use_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;test_kwargs&#39;</span><span class="p">:</span> <span class="n">test_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;strasse&#39;</span><span class="p">,</span>
    <span class="s1">&#39;assign_undefined&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;cover&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;inf_operation&#39;</span><span class="p">:</span> <span class="n">inf_operation</span><span class="p">,</span>
    <span class="s1">&#39;regional_label&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;label_map&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">}</span>

<span class="n">strasse</span> <span class="o">=</span> <span class="n">luse</span><span class="o">.</span><span class="n">LanduseConfiguration</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="n">strasse</span><span class="o">.</span><span class="n">groups_and_presence</span><span class="p">()</span>
<span class="n">strasse</span><span class="o">.</span><span class="n">inference_groups</span><span class="p">()</span>
<span class="n">sxf</span> <span class="o">=</span> <span class="n">strasse</span><span class="o">.</span><span class="n">grouped_data</span>
<span class="n">sx_conf</span> <span class="o">=</span> <span class="n">strasse</span><span class="o">.</span><span class="n">labeled_groups</span>
<span class="n">strasse_config</span> <span class="o">=</span> <span class="n">strasse</span><span class="o">.</span><span class="n">configuration_keys</span>

<span class="c1"># add the data from another land use layer</span>
<span class="c1"># the results will be added to the landcover data frame</span>
<span class="c1"># column_rename = {&quot;undefined&quot;:&quot;Undefined&quot;}</span>
<span class="n">data_map_name</span> <span class="o">=</span> <span class="s1">&#39;lake-locations-freizeitareal&#39;</span>
<span class="n">id_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;OBJEKTART&quot;</span><span class="p">]</span>
<span class="n">agg_val</span> <span class="o">=</span> <span class="s2">&quot;surface&quot;</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;river_bass&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location&quot;</span><span class="p">,</span>
    <span class="s2">&quot;city&quot;</span><span class="p">,</span>
    <span class="s2">&quot;feature&quot;</span>
<span class="p">]</span>

<span class="n">recreation_data</span> <span class="o">=</span> <span class="n">data_map</span><span class="p">[</span><span class="n">data_map_name</span><span class="p">]</span>
<span class="c1"># identify the columns of interest</span>
<span class="n">rec_groups</span> <span class="o">=</span> <span class="n">recreation_data</span><span class="o">.</span><span class="n">OBJEKTART</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">rec_presence</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">groups_and_presence</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">rec_groups</span><span class="p">,</span> <span class="o">*</span><span class="n">rec_presence</span><span class="p">]</span>
<span class="c1"># update the key word arguments for the land use data</span>
<span class="n">land_use_update</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data_map</span><span class="o">=</span><span class="n">recreation_data</span><span class="p">,</span> <span class="n">id_vals</span><span class="o">=</span><span class="n">id_vals</span><span class="p">,</span> <span class="n">to_aggregate</span><span class="o">=</span><span class="n">agg_val</span><span class="p">,</span> <span class="n">land_use_groups</span><span class="o">=</span><span class="n">rec_groups</span><span class="p">)</span>
<span class="n">land_use_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">land_use_update</span><span class="p">)</span>

<span class="c1"># update the key word arguments for the test data</span>
<span class="n">test_update</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">rec_groups</span><span class="p">,</span> <span class="n">presence</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">test_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">test_update</span><span class="p">)</span>

<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;land_use_kwargs&#39;</span><span class="p">:</span> <span class="n">land_use_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;test_kwargs&#39;</span><span class="p">:</span> <span class="n">test_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;recreation&#39;</span><span class="p">,</span>
    <span class="s1">&#39;assign_undefined&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;cover&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;inf_operation&#39;</span><span class="p">:</span> <span class="n">inf_operation</span><span class="p">,</span>
    <span class="s1">&#39;regional_label&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;label_map&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">}</span>

<span class="n">recreation</span> <span class="o">=</span> <span class="n">luse</span><span class="o">.</span><span class="n">LanduseConfiguration</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">recreation</span><span class="o">.</span><span class="n">groups_and_presence</span><span class="p">()</span>
<span class="n">recreation</span><span class="o">.</span><span class="n">inference_groups</span><span class="p">()</span>
<span class="n">rec_config</span> <span class="o">=</span> <span class="n">recreation</span><span class="o">.</span><span class="n">configuration_keys</span>

<span class="c1"># add the data from another land use layer</span>
<span class="c1"># the results will be added to the landcover data frame</span>
<span class="n">data_map_name</span> <span class="o">=</span> <span class="s1">&#39;lake-locations-nutuzungsareal&#39;</span>
<span class="n">id_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;OBJEKTART&quot;</span><span class="p">]</span>
<span class="n">agg_val</span> <span class="o">=</span> <span class="s2">&quot;surface&quot;</span>

<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;river_bass&quot;</span><span class="p">,</span>
    <span class="s2">&quot;location&quot;</span><span class="p">,</span> 
    <span class="s2">&quot;city&quot;</span><span class="p">,</span>
    <span class="s2">&quot;feature&quot;</span>
<span class="p">]</span>


<span class="n">infrastructure_data</span> <span class="o">=</span> <span class="n">data_map</span><span class="p">[</span><span class="n">data_map_name</span><span class="p">]</span>

<span class="c1"># identify the columns of interest</span>
<span class="n">inf_groups</span> <span class="o">=</span> <span class="n">infrastructure_data</span><span class="o">.</span><span class="n">OBJEKTART</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">inf_presence</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">groups_and_presence</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">inf_groups</span><span class="p">,</span> <span class="o">*</span><span class="n">inf_presence</span><span class="p">]</span>
<span class="c1"># update the key word arguments for the land use data</span>
<span class="n">land_use_update</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data_map</span><span class="o">=</span><span class="n">infrastructure_data</span><span class="p">,</span> <span class="n">id_vals</span><span class="o">=</span><span class="n">id_vals</span><span class="p">,</span> <span class="n">to_aggregate</span><span class="o">=</span><span class="n">agg_val</span><span class="p">,</span> <span class="n">land_use_groups</span><span class="o">=</span><span class="n">inf_groups</span><span class="p">)</span>
<span class="n">land_use_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">land_use_update</span><span class="p">)</span>

<span class="c1"># update the key word arguments for the test data</span>
<span class="n">test_update</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">inf_groups</span><span class="p">,</span> <span class="n">presence</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">test_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">test_update</span><span class="p">)</span>

<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;land_use_kwargs&#39;</span><span class="p">:</span> <span class="n">land_use_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;test_kwargs&#39;</span><span class="p">:</span> <span class="n">test_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s1">&#39;infrastructure&#39;</span><span class="p">,</span>
    <span class="s1">&#39;assign_undefined&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;cover&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;inf_operation&#39;</span><span class="p">:</span> <span class="n">inf_operation</span><span class="p">,</span>
    <span class="s1">&#39;regional_label&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;label_map&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">}</span>

<span class="n">infrastructure</span> <span class="o">=</span> <span class="n">luse</span><span class="o">.</span><span class="n">LanduseConfiguration</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">infrastructure</span><span class="o">.</span><span class="n">groups_and_presence</span><span class="p">()</span>
<span class="n">infrastructure</span><span class="o">.</span><span class="n">inference_groups</span><span class="p">()</span>
<span class="n">inra_config</span> <span class="o">=</span> <span class="n">infrastructure</span><span class="o">.</span><span class="n">configuration_keys</span>

<span class="n">data_map_name</span> <span class="o">=</span> <span class="s1">&#39;resources/hex-3000m-cleaned/river-intersect-length.csv&#39;</span>
<span class="n">intersections</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_map_name</span><span class="p">)</span>
<span class="n">n_c_names</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;KLASSE&quot;</span><span class="p">:</span> <span class="s1">&#39;class&#39;</span><span class="p">,</span>
    <span class="s2">&quot;NAMN&quot;</span><span class="p">:</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span>
    <span class="s2">&quot;BREITE&quot;</span><span class="p">:</span> <span class="s1">&#39;size&#39;</span><span class="p">,</span>
<span class="p">}</span>
<span class="n">intersections</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">n_c_names</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">intersections</span> <span class="o">=</span> <span class="n">intersections</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">])</span>
<span class="n">dints</span> <span class="o">=</span> <span class="n">intersections</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">nints</span> <span class="o">=</span> <span class="n">intersections</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">ints_d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dints</span><span class="o">/</span><span class="n">nints</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">ints_d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">ints_d</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="s2">&quot;distance&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">river_length</span> <span class="o">=</span> <span class="n">intersections</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">river_length</span> <span class="o">=</span> <span class="n">river_length</span><span class="o">.</span><span class="n">drop_duplicates</span><span class="p">([</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">])</span>
<span class="n">nlen</span> <span class="o">=</span> <span class="n">river_length</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">llen</span> <span class="o">=</span> <span class="n">river_length</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">length</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">lengths_d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">llen</span><span class="o">/</span><span class="n">nlen</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">len_d</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">lengths_d</span><span class="p">,</span> <span class="n">id_vars</span><span class="o">=</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="s2">&quot;length&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">id_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">]</span>
<span class="n">agg_val</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span>
<span class="n">inf_groups</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;distance&quot;</span><span class="p">]</span>
<span class="n">inf_presence</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">groups_and_presence</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">inf_groups</span><span class="p">,</span> <span class="o">*</span><span class="n">inf_presence</span><span class="p">]</span>



<span class="c1"># update the key word arguments for the land use data</span>
<span class="n">land_use_update</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data_map</span><span class="o">=</span><span class="n">ints_d</span><span class="p">,</span> <span class="n">id_vals</span><span class="o">=</span><span class="n">id_vals</span><span class="p">,</span> <span class="n">to_aggregate</span><span class="o">=</span><span class="n">agg_val</span><span class="p">,</span> <span class="n">land_use_groups</span><span class="o">=</span><span class="n">inf_groups</span><span class="p">)</span>
<span class="n">land_use_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">land_use_update</span><span class="p">)</span>

<span class="c1"># update the key word arguments for the test data</span>
<span class="n">test_update</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">inf_groups</span><span class="p">,</span> <span class="n">presence</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">test_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">test_update</span><span class="p">)</span>

<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;land_use_kwargs&#39;</span><span class="p">:</span> <span class="n">land_use_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;test_kwargs&#39;</span><span class="p">:</span> <span class="n">test_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;r-distance&quot;</span><span class="p">,</span>
    <span class="s1">&#39;assign_undefined&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;cover&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;inf_operation&#39;</span><span class="p">:</span> <span class="n">inf_operation</span><span class="p">,</span>
    <span class="s1">&#39;regional_label&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;label_map&#39;</span><span class="p">:</span> <span class="n">label_map</span><span class="p">,</span>
    <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">}</span>

<span class="n">distance</span> <span class="o">=</span> <span class="n">luse</span><span class="o">.</span><span class="n">LanduseConfiguration</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">distance</span><span class="o">.</span><span class="n">groups_and_presence</span><span class="p">()</span>
<span class="n">distance</span><span class="o">.</span><span class="n">inference_groups</span><span class="p">()</span>
<span class="n">dist_conf</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">configuration_keys</span>

<span class="n">id_vals</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;variable&quot;</span><span class="p">]</span>
<span class="n">agg_val</span> <span class="o">=</span> <span class="s2">&quot;value&quot;</span>
<span class="n">inf_groups</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;length&quot;</span><span class="p">]</span>
<span class="n">inf_presence</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">groups_and_presence</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">inf_groups</span><span class="p">,</span> <span class="o">*</span><span class="n">inf_presence</span><span class="p">]</span>



<span class="c1"># update the key word arguments for the land use data</span>
<span class="n">land_use_update</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">data_map</span><span class="o">=</span><span class="n">len_d</span><span class="p">,</span> <span class="n">id_vals</span><span class="o">=</span><span class="n">id_vals</span><span class="p">,</span> <span class="n">to_aggregate</span><span class="o">=</span><span class="n">agg_val</span><span class="p">,</span> <span class="n">land_use_groups</span><span class="o">=</span><span class="n">inf_groups</span><span class="p">)</span>
<span class="n">land_use_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">land_use_update</span><span class="p">)</span>

<span class="c1"># update the key word arguments for the test data</span>
<span class="n">test_update</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">groups</span><span class="o">=</span><span class="n">inf_groups</span><span class="p">,</span> <span class="n">presence</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">test_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">test_update</span><span class="p">)</span>



<span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;land_use_kwargs&#39;</span><span class="p">:</span> <span class="n">land_use_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;test_kwargs&#39;</span><span class="p">:</span> <span class="n">test_kwargs</span><span class="p">,</span>
    <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="s2">&quot;r-length&quot;</span><span class="p">,</span>
    <span class="s1">&#39;assign_undefined&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;length&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
    <span class="s1">&#39;cover&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
    <span class="s1">&#39;inf_operation&#39;</span><span class="p">:</span> <span class="n">inf_operation</span><span class="p">,</span>
    <span class="s1">&#39;regional_label&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;label_map&#39;</span><span class="p">:</span> <span class="n">label_map</span><span class="p">,</span>
    <span class="s1">&#39;total&#39;</span><span class="p">:</span> <span class="kc">True</span>
<span class="p">}</span>

<span class="n">intersections</span> <span class="o">=</span> <span class="n">luse</span><span class="o">.</span><span class="n">LanduseConfiguration</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="n">intersections</span><span class="o">.</span><span class="n">groups_and_presence</span><span class="p">()</span>
<span class="n">intersections</span><span class="o">.</span><span class="n">inference_groups</span><span class="p">()</span>
<span class="n">int_conf</span> <span class="o">=</span> <span class="n">intersections</span><span class="o">.</span><span class="n">configuration_keys</span>

<span class="c1"># add results for land use to land cover </span>
<span class="c1"># drop the conf column</span>
<span class="n">fgl</span> <span class="o">=</span> <span class="n">nx_conf</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;conf&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fgl</span><span class="p">[</span><span class="s1">&#39;infrastructure&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fgl</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">inra_config</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">fgl</span><span class="p">[</span><span class="s1">&#39;strasse&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fgl</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">strasse_config</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">fgl</span><span class="p">[</span><span class="s1">&#39;recreation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fgl</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rec_config</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">fgl</span><span class="p">[</span><span class="s1">&#39;r-length&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fgl</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">int_conf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">fgl</span><span class="p">[</span><span class="s1">&#39;r-distance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fgl</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dist_conf</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">fgl</span> <span class="o">=</span> <span class="n">fgl</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># define the confiugration columns</span>
<span class="n">conf_columns</span> <span class="o">=</span> <span class="p">[</span><span class="o">*</span><span class="n">lc_groups</span><span class="p">,</span> <span class="o">*</span><span class="n">lc_presence</span><span class="p">,</span> <span class="s1">&#39;infrastructure&#39;</span><span class="p">,</span> <span class="s1">&#39;strasse&#39;</span><span class="p">,</span> <span class="s1">&#39;recreation&#39;</span><span class="p">,</span> <span class="s1">&#39;r-length&#39;</span><span class="p">,</span> <span class="s1">&#39;r-distance&#39;</span><span class="p">]</span>
<span class="n">fgl</span><span class="p">[</span><span class="s1">&#39;configuration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">fgl</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">conf_columns</span><span class="p">]))</span>
<span class="n">fgl_conf_keys</span> <span class="o">=</span> <span class="n">fgl</span><span class="p">[[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;configuration&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;location&quot;</span><span class="p">)</span>

<span class="c1"># update the probability tables</span>
<span class="n">fgl_ptables</span> <span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">p_tables</span>
<span class="n">fgl_ptables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">infrastructure</span><span class="o">.</span><span class="n">p_tables</span><span class="p">)</span>
<span class="n">fgl_ptables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">recreation</span><span class="o">.</span><span class="n">p_tables</span><span class="p">)</span>
<span class="n">fgl_ptables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">strasse</span><span class="o">.</span><span class="n">p_tables</span><span class="p">)</span>
<span class="n">fgl_ptables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">intersections</span><span class="o">.</span><span class="n">p_tables</span><span class="p">)</span>
<span class="n">fgl_ptables</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">distance</span><span class="o">.</span><span class="n">p_tables</span><span class="p">)</span>

<span class="n">inference_kwargs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;location&#39;</span><span class="p">:</span> <span class="s2">&quot; &quot;</span><span class="p">,</span>
    <span class="s1">&#39;lake&#39;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
    <span class="s1">&#39;conf_label&#39;</span><span class="p">:</span> <span class="s1">&#39;configuration&#39;</span><span class="p">,</span>
    <span class="s1">&#39;fgl_conf_keys&#39;</span><span class="p">:</span><span class="n">fgl_conf_keys</span><span class="p">,</span>
    <span class="s1">&#39;conf_columns&#39;</span><span class="p">:</span> <span class="n">conf_columns</span><span class="p">,</span>
    <span class="s1">&#39;p_tables&#39;</span><span class="p">:</span> <span class="n">fgl_ptables</span><span class="p">,</span>
    <span class="s1">&#39;tested&#39;</span><span class="p">:</span><span class="n">nx</span><span class="o">.</span><span class="n">grouped_data</span><span class="p">,</span>
    <span class="s1">&#39;prior&#39;</span><span class="p">:</span><span class="kc">None</span><span class="p">,</span>
    <span class="s1">&#39;drop_vals&#39;</span><span class="p">:</span> <span class="kc">None</span>
<span class="p">}</span>



<span class="n">bsee_l</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">grouped_data</span><span class="p">[</span><span class="n">nx</span><span class="o">.</span><span class="n">grouped_data</span><span class="o">.</span><span class="n">lake</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">features_of_interest</span><span class="p">)]</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
<span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">alocation</span> <span class="ow">in</span> <span class="n">bsee_l</span><span class="p">:</span>
    <span class="n">inference_kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;location&quot;</span><span class="p">:</span><span class="n">alocation</span><span class="p">})</span>
    <span class="n">p</span><span class="o">=</span><span class="n">luse</span><span class="o">.</span><span class="n">inference_for_one_location</span><span class="p">(</span><span class="o">**</span><span class="n">inference_kwargs</span><span class="p">)</span>
    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;location&#39;</span><span class="p">:</span><span class="n">alocation</span><span class="p">,</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span><span class="n">p</span><span class="p">})</span>

<span class="n">lct</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">test_results</span><span class="o">.</span><span class="n">test_and_merge</span><span class="p">()</span>
<span class="n">sct</span> <span class="o">=</span> <span class="n">strasse</span><span class="o">.</span><span class="n">test_results</span><span class="o">.</span><span class="n">test_and_merge</span><span class="p">(</span><span class="n">cover</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">rct</span> <span class="o">=</span> <span class="n">recreation</span><span class="o">.</span><span class="n">test_results</span><span class="o">.</span><span class="n">test_and_merge</span><span class="p">(</span><span class="n">cover</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ict</span> <span class="o">=</span> <span class="n">infrastructure</span><span class="o">.</span><span class="n">test_results</span><span class="o">.</span><span class="n">test_and_merge</span><span class="p">(</span><span class="n">cover</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dist_ct</span> <span class="o">=</span> <span class="n">distance</span><span class="o">.</span><span class="n">test_results</span><span class="o">.</span><span class="n">test_and_merge</span><span class="p">(</span><span class="n">cover</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ints_ct</span> <span class="o">=</span> <span class="n">intersections</span><span class="o">.</span><span class="n">test_results</span><span class="o">.</span><span class="n">test_and_merge</span><span class="p">(</span><span class="n">cover</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">dfs</span> <span class="o">=</span> <span class="p">[</span><span class="n">lct</span><span class="p">,</span> <span class="n">sct</span><span class="p">,</span> <span class="n">rct</span><span class="p">,</span> <span class="n">ict</span><span class="p">,</span> <span class="n">dist_ct</span><span class="p">,</span> <span class="n">ints_ct</span><span class="p">]</span>

<span class="n">p_of</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="section" id="what-is-the-chance-of-exceeding-the-median">
<h2><span class="section-number">6.1. </span>What is the chance of exceeding the median?<a class="headerlink" href="#what-is-the-chance-of-exceeding-the-median" title="Permalink to this headline">#</a></h2>
<p>The land use data for each location is tested with respect to the survey results for a given object.</p>
<ol class="arabic simple">
<li><p>Object: Gfrags, fragmented plastics &gt; 0.5 mm</p></li>
<li><p>The median value of all the data is 0.23 pieces per meter</p></li>
</ol>
<p>Each graph represents the</p>
<div class="section" id="infrastructure">
<h3><span class="section-number">6.1.1. </span>Infrastructure<a class="headerlink" href="#infrastructure" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
<span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">expit</span>
<span class="n">to_test</span><span class="p">[</span><span class="s2">&quot;failed&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">pcs_m</span> <span class="o">&gt;</span> <span class="n">threshhold</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
<span class="n">log_of</span> <span class="o">=</span> <span class="n">to_test</span><span class="p">[[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;failed&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;infrastructure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ict</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ict</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;infrastructure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;infrastructure&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">infrastructure</span><span class="o">/</span><span class="mi">1000000</span>

<span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">infrastructure</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">log_of</span><span class="o">.</span><span class="n">infrastructure</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;failed ~ infrastructure&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">log_of</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">inter</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;infrastructure&#39;</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

<span class="n">log_odds</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span>
<span class="n">odds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_odds</span><span class="p">)</span>

<span class="n">ps_x</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps_x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;infrastructure&quot;</span><span class="p">],</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;failed&quot;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Infrastructure&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Kilometers²&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability of exceeding threshhold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">.1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/973e16549b234340eb8e41ee55d15c212e6d9d4022b5459065f280586340de92.png" src="_images/973e16549b234340eb8e41ee55d15c212e6d9d4022b5459065f280586340de92.png" />
</div>
</div>
</div>
<div class="section" id="urbanization">
<h3><span class="section-number">6.1.2. </span>Urbanization<a class="headerlink" href="#urbanization" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_of</span> <span class="o">=</span> <span class="n">to_test</span><span class="p">[[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;failed&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;Siedl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">lct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lct</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;Siedl&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;Siedl&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">Siedl</span><span class="o">/</span><span class="mi">1000000</span>

<span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">Siedl</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">log_of</span><span class="o">.</span><span class="n">Siedl</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;failed ~ Siedl&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">log_of</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">inter</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Siedl&#39;</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

<span class="n">log_odds</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span>
<span class="n">odds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_odds</span><span class="p">)</span>

<span class="n">ps_x</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps_x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;Siedl&quot;</span><span class="p">],</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;failed&quot;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Buildings/urban&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Kilometers²&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability of exceeding threshhold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">.1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/a6598e31f9b8543fb0d5835b6faff07642f4ba978f593c3ce0459d00a33aef97.png" src="_images/a6598e31f9b8543fb0d5835b6faff07642f4ba978f593c3ce0459d00a33aef97.png" />
</div>
</div>
</div>
<div class="section" id="forest">
<h3><span class="section-number">6.1.3. </span>Forest<a class="headerlink" href="#forest" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_of</span> <span class="o">=</span> <span class="n">to_test</span><span class="p">[[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;failed&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;Wald&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">lct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lct</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;Wald&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;Wald&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">Wald</span><span class="o">/</span><span class="mi">1000000</span>

<span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">Wald</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">log_of</span><span class="o">.</span><span class="n">Wald</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;failed ~ Wald&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">log_of</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">inter</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Wald&#39;</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

<span class="n">log_odds</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span>
<span class="n">odds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_odds</span><span class="p">)</span>

<span class="n">ps_x</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps_x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;Wald&quot;</span><span class="p">],</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;failed&quot;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Forests/woods&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Kilometers²&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability of exceeding threshhold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">.1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/d9d13306075ba0b5b9683207d7c306c7bd4ca0efd4e87fc3ee75a09ef63ff37c.png" src="_images/d9d13306075ba0b5b9683207d7c306c7bd4ca0efd4e87fc3ee75a09ef63ff37c.png" />
</div>
</div>
</div>
<div class="section" id="undefined">
<h3><span class="section-number">6.1.4. </span>Undefined<a class="headerlink" href="#undefined" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_of</span> <span class="o">=</span> <span class="n">to_test</span><span class="p">[[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;failed&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;Undefined&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">lct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">lct</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;Undefined&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;Undefined&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">Undefined</span><span class="o">/</span><span class="mi">1000000</span>

<span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">Undefined</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">log_of</span><span class="o">.</span><span class="n">Undefined</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;failed ~ Undefined&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">log_of</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">inter</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Undefined&#39;</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

<span class="n">log_odds</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span>
<span class="n">odds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_odds</span><span class="p">)</span>

<span class="n">ps_x</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps_x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;Undefined&quot;</span><span class="p">],</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;failed&quot;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Land use not defined in map&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Kilometers²&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability of exceeding threshhold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">.1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/6ba8398cbec6bb475a7371bb454c0c79aa9f199b819c498001f9f0117f879b74.png" src="_images/6ba8398cbec6bb475a7371bb454c0c79aa9f199b819c498001f9f0117f879b74.png" />
</div>
</div>
</div>
<div class="section" id="recreation">
<h3><span class="section-number">6.1.5. </span>Recreation<a class="headerlink" href="#recreation" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_of</span> <span class="o">=</span> <span class="n">to_test</span><span class="p">[[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;failed&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;recreation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">rct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">rct</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;recreation&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;recreation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">recreation</span><span class="o">/</span><span class="mi">1000000</span>

<span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">recreation</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">log_of</span><span class="o">.</span><span class="n">recreation</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;failed ~ recreation&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">log_of</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">inter</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;recreation&#39;</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

<span class="n">log_odds</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span>
<span class="n">odds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_odds</span><span class="p">)</span>

<span class="n">ps_x</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps_x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;recreation&quot;</span><span class="p">],</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;failed&quot;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Recreation/sports/camping&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Kilometers²&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability of exceeding threshhold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">.1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/d23691c6ff1b6140928f335c3279899b68b1963c39c7bd07393f17659415db1a.png" src="_images/d23691c6ff1b6140928f335c3279899b68b1963c39c7bd07393f17659415db1a.png" />
</div>
</div>
</div>
<div class="section" id="distance-to-river-intersection">
<h3><span class="section-number">6.1.6. </span>Distance to river intersection<a class="headerlink" href="#distance-to-river-intersection" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_of</span> <span class="o">=</span> <span class="n">to_test</span><span class="p">[[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;failed&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r-distance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">dist_ct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">dist_ct</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;r-distance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r-distance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r-distance&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">log_of</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;r-distance&#39;</span><span class="p">:</span><span class="s1">&#39;r_distance&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span> <span class="o">=</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r_distance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r_distance&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;failed ~ r_distance&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">log_of</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">inter</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;r_distance&#39;</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

<span class="n">log_odds</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span>
<span class="n">odds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_odds</span><span class="p">)</span>

<span class="n">ps_x</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps_x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r_distance&quot;</span><span class="p">],</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;failed&quot;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Distance to river intersection&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Kilometers&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability of exceeding threshhold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">.1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/21731fddf4634703f0a96a6d15c4ff314394ad14ce4f6c5500e94ff7fd5b2740.png" src="_images/21731fddf4634703f0a96a6d15c4ff314394ad14ce4f6c5500e94ff7fd5b2740.png" />
</div>
</div>
</div>
<div class="section" id="length-of-river-intersects">
<h3><span class="section-number">6.1.7. </span>Length of river intersects<a class="headerlink" href="#length-of-river-intersects" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">log_of</span> <span class="o">=</span> <span class="n">to_test</span><span class="p">[[</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="s2">&quot;failed&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r-length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">ints_ct</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ints_ct</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;r-length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r-length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r-length&quot;</span><span class="p">]</span><span class="o">/</span><span class="mi">1000</span>
<span class="n">log_of</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;r-length&#39;</span><span class="p">:</span><span class="s1">&#39;r_length&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span> <span class="o">=</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r_length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r_length&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="n">formula</span> <span class="o">=</span> <span class="s1">&#39;failed ~ r_length&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">logit</span><span class="p">(</span><span class="n">formula</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">log_of</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">disp</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">inter</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;Intercept&#39;</span><span class="p">]</span>
<span class="n">slope</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;r_length&#39;</span><span class="p">]</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">obj_min</span><span class="p">,</span> <span class="n">obj_max</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

<span class="n">log_odds</span> <span class="o">=</span> <span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span>
<span class="n">odds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_odds</span><span class="p">)</span>

<span class="n">ps_x</span> <span class="o">=</span> <span class="n">expit</span><span class="p">(</span><span class="n">inter</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">xs</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ps_x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;r_length&quot;</span><span class="p">],</span> <span class="n">log_of</span><span class="p">[</span><span class="s2">&quot;failed&quot;</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Length of intersecting rivers in buffer&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Kilometers&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Probability of exceeding threshhold&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">.1</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/35674131e5e442eefefa00815f28e0b47fc6a8daf4cc3f9923e4cc2dfd05db57.png" src="_images/35674131e5e442eefefa00815f28e0b47fc6a8daf4cc3f9923e4cc2dfd05db57.png" />
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<p>This script updated 09/05/2023 in Biel, CH</p>
<blockquote>
<div><p>❤️ what you do everyday</p>
</div></blockquote>
<p><em>analyst at hammerdirt</em></p>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Git repo: https://github.com/hammerdirt-analyst/landuse.git

Git branch: main

statsmodels: 0.13.5
json       : 2.0.9
matplotlib : 3.7.1
seaborn    : 0.12.2
numpy      : 1.24.2
IPython    : 8.12.0
PIL        : 9.5.0
scipy      : 1.10.1
pandas     : 2.0.0
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="hex-3000-m.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">5. </span>All Data – New map data</p>
      </div>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-the-chance-of-exceeding-the-median">6.1. What is the chance of exceeding the median?</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#infrastructure">6.1.1. Infrastructure</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#urbanization">6.1.2. Urbanization</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forest">6.1.3. Forest</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#undefined">6.1.4. Undefined</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#recreation">6.1.5. Recreation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distance-to-river-intersection">6.1.6. Distance to river intersection</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#length-of-river-intersects">6.1.7. Length of river intersects</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Schreyer et all
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
   hammerdirt 2023
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>