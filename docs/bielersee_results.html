

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1. Bielersee &#8212; Near or far</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'bielersee_results';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="2. Lac Léman" href="lac_leman.html" />
    <link rel="prev" title="Assessing land-use influence on macrolitter abundance in freshwater systems" href="titlepage.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="titlepage.html">
  
  
  
  
  
    <p class="title logo__title">Near or far</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">1. Bielersee</a></li>
<li class="toctree-l1"><a class="reference internal" href="lac_leman.html">2. Lac Léman</a></li>
<li class="toctree-l1"><a class="reference internal" href="project_results.html">3. All Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="consider_distance_to_river.html">4. River and lake intersections</a></li>
<li class="toctree-l1"><a class="reference internal" href="hex-3000-m.html">5. All Data – New map data</a></li>
<li class="toctree-l1"><a class="reference internal" href="probability.html">6. Logistic regression</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/hammerdirt-analyst/landuse" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/hammerdirt-analyst/landuse/issues/new?title=Issue%20on%20page%20%2Fbielersee_results.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Bielersee</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#esitmating-landuse">1.1. Esitmating landuse</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-road-and-river-network">1.1.1. Estimating the road and river network</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#map-of-survey-locations-and-aggregated-results">1.2. Map of survey locations and aggregated results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-a-collection-of-locations">1.3. <em>Ρ</em> for a collection of locations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-of-codes-of-interest">1.3.1. Definition of codes of interest</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ranked-correlation-of-the-most-common-objects-on-bielersee">1.3.2. Ranked correlation of the most common objects on Bielersee</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#covariance-of-explanatory-variables">1.4. Covariance of explanatory variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#total-correlations-total-positive-correlations-and-total-negative-corrrelations">1.5. Total correlations, total positive correlations and total negative corrrelations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sum-of-the-total-number-of-objects-with-a-correlation-positive-or-negative-collected-under-the-different-land-use-categories">1.5.1. Sum of the total number of objects with a correlation (positive or negative) collected under the different land use categories</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-objects-of-interest">1.6. The objects of interest</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-total-of-materials-of-the-objects-of-interest-with-respect-to-the-total-number-of-objects-collected">1.6.1. The % total of materials of the objects of interest with respect to the total number of objects collected.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-total-of-the-top-10-objects-with-respect-to-all-objects-collected">1.6.2. The % total of the top 10 objects with respect to all objects collected.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-cumulative-totals-of-the-top-20-objects-grouped-by-economic-source">1.6.3. The cumulative totals of the top 20 objects, grouped by economic source</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litter-items-of-local-origin">1.6.3.1. Litter items of local origin</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ubiquitous-items">1.6.3.2. Ubiquitous items</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#other-items">1.6.3.3. Other items</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> watermark

<span class="c1"># sys, file and nav packages:</span>
<span class="kn">import</span> <span class="nn">datetime</span> <span class="k">as</span> <span class="nn">dt</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># math packages:</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
<span class="kn">from</span> <span class="nn">statsmodels.distributions.empirical_distribution</span> <span class="kn">import</span> <span class="n">ECDF</span>

<span class="c1"># charting:</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.dates</span> <span class="k">as</span> <span class="nn">mdates</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">ticker</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">colors</span>
<span class="kn">from</span> <span class="nn">matplotlib.colors</span> <span class="kn">import</span> <span class="n">LinearSegmentedColormap</span>
<span class="kn">from</span> <span class="nn">matplotlib.gridspec</span> <span class="kn">import</span> <span class="n">GridSpec</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1.inset_locator</span> <span class="kn">import</span> <span class="n">inset_axes</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">import</span> <span class="nn">IPython</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span> <span class="k">as</span> <span class="n">PILImage</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Markdown</span> <span class="k">as</span> <span class="n">md</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">display</span>
<span class="kn">from</span> <span class="nn">myst_nb</span> <span class="kn">import</span> <span class="n">glue</span>

<span class="kn">import</span> <span class="nn">time</span>

<span class="n">start_date</span> <span class="o">=</span> <span class="s1">&#39;2020-03-01&#39;</span>
<span class="n">end_date</span> <span class="o">=</span><span class="s1">&#39;2021-05-31&#39;</span>

<span class="n">a_qty</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">a_fail_rate</span> <span class="o">=</span> <span class="mf">.5</span>

<span class="n">use_fail</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">unit_label</span> <span class="o">=</span> <span class="s1">&#39;p/100m&#39;</span>

<span class="c1"># survey data:</span>
<span class="n">dfx</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;resources/checked_sdata_eos_2020_21.csv&#39;</span><span class="p">)</span>

<span class="n">dfBeaches</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;resources/beaches_with_land_use_rates.csv&quot;</span><span class="p">)</span>
<span class="n">dfCodes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;resources/codes_with_group_names_2015.csv&quot;</span><span class="p">)</span>

<span class="c1"># set the index of the beach data to location slug</span>
<span class="n">dfBeaches</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;slug&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># set the index of to codes</span>
<span class="n">dfCodes</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># code description map</span>
<span class="n">code_d_map</span> <span class="o">=</span> <span class="n">dfCodes</span><span class="o">.</span><span class="n">description</span>

<span class="c1"># code material map</span>
<span class="n">code_m_map</span> <span class="o">=</span> <span class="n">dfCodes</span><span class="o">.</span><span class="n">material</span>

<span class="n">new_descriptions</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;Industrial pellets (nurdles)&#39;</span><span class="p">:</span> <span class="s1">&#39;Pellets&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Glass drink bottles, pieces&#39;</span><span class="p">:</span> <span class="s1">&#39;Glass bottles and pieces&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Food wrappers; candy, snacks&#39;</span><span class="p">:</span> <span class="s1">&#39;Food wrappers&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Food wrappers; candy, snacks&#39;</span><span class="p">:</span> <span class="s1">&#39;Food wrappers&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Foam packaging/insulation/polyurethane&#39;</span><span class="p">:</span> <span class="s1">&#39;Foam packaging for insulation&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Packaging films nonfood or unknown&#39;</span><span class="p">:</span> <span class="s1">&#39;Packaging films (not food-related)&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Lids unidentified&#39;</span><span class="p">:</span> <span class="s1">&#39;Other lids&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Tobacco; plastic packaging, containers&#39;</span><span class="p">:</span> <span class="s1">&#39;Plastic packaging for tobacco&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Fireworks paper tubes and fragments&#39;</span><span class="p">:</span> <span class="s1">&#39;Fireworks (paper parts)&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Diapers - wipes&#39;</span><span class="p">:</span> <span class="s1">&#39;Diapers and wipes&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Foamed items &amp; pieces (non packaging/insulation) foamed sponge material&#39;</span><span class="p">:</span> <span class="s1">&#39;Foam items and pieces (not insulation)&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Labels, bar codes&#39;</span><span class="p">:</span> <span class="s1">&#39;Labels and bar codes&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Sanitary pads /panty liners/tampons and applicators&#39;</span><span class="p">:</span> <span class="s1">&#39;Sanitary pads, tampons and applicators&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Pellet mass from injection molding&#39;</span><span class="p">:</span> <span class="s1">&#39;Pellet mass&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Bags; plastic shopping/carrier/grocery and pieces&#39;</span><span class="p">:</span> <span class="s1">&#39;Plastic bags and pieces&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Lids for chemicals, detergents (non-food)&#39;</span><span class="p">:</span> <span class="s1">&#39;Lids for chemicals and detergents&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Coverings; plastic packaging, sheeting for protecting large cargo items&#39;</span><span class="p">:</span> <span class="s1">&#39;Plastic sheeting for large cargo items&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Construction material; bricks, pipes, cement&#39;</span><span class="p">:</span> <span class="s1">&#39;Construction materials (bricks, pipes, cement)&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Fireworks; rocket caps, exploded parts &amp; packaging&#39;</span><span class="p">:</span> <span class="s1">&#39;Fireworks (rocket caps, exploded parts and packaging)&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Foamed EVA (flexible plastic) for crafts &amp; watersports&#39;</span><span class="p">:</span> <span class="s1">&#39;Foamed EVA&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Metal bottle caps, lids &amp; pull tabs from cans&#39;</span><span class="p">:</span> <span class="s1">&#39;Metal bottle caps, lids and pull tabs from cans&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Lid/cap rings from plastic bottles/containers&#39;</span><span class="p">:</span> <span class="s1">&#39;Lids and cap rings from plastic bottles&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Tissue, toilet paper, napkins, paper towels&#39;</span><span class="p">:</span> <span class="s1">&#39;Tissues, toilet paper and paper towels&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Cotton bud/swab sticks&#39;</span><span class="p">:</span> <span class="s1">&#39;Cotton buds and swab sticks&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Foil wrappers, aluminum foil&#39;</span><span class="p">:</span> <span class="s1">&#39;Aluminum foil&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Clothing, towels &amp; rags&#39;</span><span class="p">:</span> <span class="s1">&#39;Clothing and rags&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Food containers single use foamed or plastic&#39;</span><span class="p">:</span> <span class="s1">&#39;Plastic food containers&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Plastic fragments angular &lt;5mm&#39;</span><span class="p">:</span> <span class="s1">&#39;Angular plastic fragments (&lt; 0.5 cm)&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Plastic fragments rounded &lt;5mm&#39;</span><span class="p">:</span> <span class="s1">&#39;Round plastic fragments (&lt; 0.5 cm)&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Foamed  plastic &lt;5mm&#39;</span><span class="p">:</span> <span class="s1">&#39;Foam plastic (&lt; 0.5 cm)&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Styrofoam &lt; 5mm&#39;</span><span class="p">:</span> <span class="s1">&#39;Styrofoam fragments (&lt; 0.5 cm)&#39;</span><span class="p">,</span> 
                    <span class="s1">&#39;Glass or ceramic fragments &gt; 2.5 cm&#39;</span><span class="p">:</span> <span class="s1">&#39;Glass and ceramic fragments (&gt; 2.5 cm)&#39;</span><span class="p">,</span>
                   <span class="p">}</span>

<span class="n">to_replace</span> <span class="o">=</span> <span class="n">new_descriptions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

<span class="c1"># this defines the css rules for the note-book table displays</span>
<span class="n">header_row</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;th:nth-child(1)&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;background-color: #FFF;&#39;</span><span class="p">}</span>
<span class="n">even_rows</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;selector&quot;</span><span class="p">:</span> <span class="s1">&#39;tr:nth-child(even)&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;background-color: rgba(139, 69, 19, 0.08);&#39;</span><span class="p">}</span>
<span class="n">odd_rows</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;tr:nth-child(odd)&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="s1">&#39;background: #FFF;&#39;</span><span class="p">}</span>
<span class="n">table_font</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;selector&#39;</span><span class="p">:</span> <span class="s1">&#39;tr&#39;</span><span class="p">,</span> <span class="s1">&#39;props&#39;</span><span class="p">:</span> <span class="s1">&#39;font-size: 12px;&#39;</span><span class="p">}</span>
<span class="n">table_css_styles</span> <span class="o">=</span> <span class="p">[</span><span class="n">even_rows</span><span class="p">,</span> <span class="n">odd_rows</span><span class="p">,</span> <span class="n">table_font</span><span class="p">,</span> <span class="n">header_row</span><span class="p">]</span>


<span class="n">pdtype</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">DataFrame</span>
<span class="n">pstype</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">series</span><span class="o">.</span><span class="n">Series</span>

<span class="n">new_label_keys</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">:</span><span class="s2">&quot;industrial&quot;</span><span class="p">,</span>
    <span class="mi">2</span><span class="p">:</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span>
    <span class="mi">3</span><span class="p">:</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span>
    <span class="mi">4</span><span class="p">:</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span>
    <span class="mi">5</span><span class="p">:</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span>
    <span class="mi">6</span><span class="p">:</span><span class="s2">&quot;transport&quot;</span><span class="p">,</span>
    <span class="mi">7</span><span class="p">:</span><span class="s2">&quot;transport&quot;</span><span class="p">,</span>
    <span class="mi">8</span><span class="p">:</span><span class="s2">&quot;transport&quot;</span><span class="p">,</span>
    <span class="mi">9</span><span class="p">:</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">:</span><span class="s2">&quot;recreation&quot;</span><span class="p">,</span>
    <span class="mi">11</span><span class="p">:</span><span class="s2">&quot;agriculture&quot;</span><span class="p">,</span>
    <span class="mi">12</span><span class="p">:</span><span class="s2">&quot;agriculture&quot;</span><span class="p">,</span>
    <span class="mi">13</span><span class="p">:</span><span class="s2">&quot;agriculture&quot;</span><span class="p">,</span>
    <span class="mi">14</span><span class="p">:</span><span class="s2">&quot;agriculture&quot;</span><span class="p">,</span>
    <span class="mi">15</span><span class="p">:</span><span class="s2">&quot;agriculture&quot;</span><span class="p">,</span>
    <span class="mi">16</span><span class="p">:</span><span class="s2">&quot;agriculture&quot;</span><span class="p">,</span>
    <span class="mi">17</span><span class="p">:</span><span class="s2">&quot;woods&quot;</span><span class="p">,</span>
    <span class="mi">18</span><span class="p">:</span><span class="s2">&quot;agriculture&quot;</span><span class="p">,</span>
    <span class="mi">19</span><span class="p">:</span><span class="s2">&quot;woods&quot;</span><span class="p">,</span>
    <span class="mi">20</span><span class="p">:</span><span class="s2">&quot;woods&quot;</span><span class="p">,</span>
    <span class="mi">21</span><span class="p">:</span><span class="s2">&quot;woods&quot;</span><span class="p">,</span>
    <span class="mi">22</span><span class="p">:</span><span class="s2">&quot;woods&quot;</span><span class="p">,</span>
    <span class="mi">23</span><span class="p">:</span><span class="s2">&quot;water&quot;</span><span class="p">,</span>
    <span class="mi">24</span><span class="p">:</span><span class="s2">&quot;water&quot;</span><span class="p">,</span>
    <span class="mi">25</span><span class="p">:</span><span class="s2">&quot;unproductive&quot;</span><span class="p">,</span>
    <span class="mi">26</span><span class="p">:</span><span class="s2">&quot;unproductive&quot;</span><span class="p">,</span>
    <span class="mi">27</span><span class="p">:</span><span class="s2">&quot;unproductive&quot;</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">combineLandUseFeatures</span><span class="p">(</span><span class="n">buffer_data</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">a_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;AS18_27&quot;</span><span class="p">,</span> <span class="n">new_col</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span>
                           <span class="n">new_label_keys</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">new_label_keys</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pdtype</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assigns labels to landuse values according to &lt;label_keys_new&gt;. The new labels,</span>
<span class="sd">    when aggregated, create groups of landuse values that are similar. For exmaple,</span>
<span class="sd">    all the different types of buildings are labeled &quot;buildings&quot;</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        buffer_data: The land use values at a given radius</span>
<span class="sd">        a_col: The original column name that holds the labels for the land use values</span>
<span class="sd">        new_col: The new name of the column with the new labels</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        The data frame with the new column and the new labels    </span>
<span class="sd">    &quot;&quot;&quot;</span>    
    
    <span class="n">buffer_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;slug&quot;</span><span class="p">:</span><span class="s2">&quot;location&quot;</span><span class="p">,</span> <span class="n">a_col</span><span class="p">:</span><span class="n">new_col</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">buffer_data</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">buffer_data</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">new_label_keys</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">buffer_data</span>

<span class="k">def</span> <span class="nf">adjustLandUse</span><span class="p">(</span><span class="n">buffer_data</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">exclude_these</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">locations</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[])</span> <span class="o">-&gt;</span> <span class="n">pdtype</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The surface area of the water feature is removed from landuse calcluation. This</span>
<span class="sd">    can be bypassed. However, the study considers the surface area of the water as a fixed</span>
<span class="sd">    feature that exchanges with the different landuse features (which are not fixed).</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        buffer_data: The land use values at a given radius</span>
<span class="sd">        exclude_these: The labels to be excluded from the land use total</span>
<span class="sd">        locations: The locations of interest with buffer data</span>
<span class="sd">        </span>
<span class="sd">    Returns:</span>
<span class="sd">        The dataframe with the locations in locations and without the excluded labels      </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">buffer_data</span><span class="p">[</span><span class="o">~</span><span class="n">buffer_data</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">exclude_these</span><span class="p">)]</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">locations</span><span class="p">)]</span>
    
    <span class="k">return</span> <span class="n">data</span>

<span class="k">def</span> <span class="nf">addRoadLengthToBuffer</span><span class="p">(</span><span class="n">buffer_data</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                          <span class="n">road_lengths</span><span class="p">:</span> <span class="n">pstype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1000.0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds the length of road network to the % land use values.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">road_length</span> <span class="o">=</span> <span class="n">road_lengths</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">location</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">scale</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">road_length</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">road_length</span><span class="o">/</span><span class="n">scale</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="n">buffer_data</span><span class="p">[</span><span class="s2">&quot;roads&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">road_length</span>
    
    <span class="k">return</span> <span class="n">buffer_data</span>

<span class="k">def</span> <span class="nf">addIntersectsToBuffer</span><span class="p">(</span><span class="n">buffer_data</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                          <span class="n">intersects</span><span class="p">:</span> <span class="n">pstype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">100.0</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Adds the number of river intersections to the buffer.</span>
<span class="sd">    </span>
<span class="sd">    The river intersections are the points where rivers join the body of water of interest</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">n_intersects</span> <span class="o">=</span> <span class="n">intersects</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">location</span><span class="p">]</span>
        
    <span class="n">buffer_data</span><span class="p">[</span><span class="s2">&quot;intersects&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_intersects</span>
    
    <span class="k">return</span> <span class="n">buffer_data</span>

<span class="k">def</span> <span class="nf">calculatePercentLandUse</span><span class="p">(</span><span class="n">buffer_data</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span><span class="p">,</span>
                           <span class="n">add_intersects_roads</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>  <span class="n">road_lengths</span><span class="p">:</span> <span class="n">pstype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">intersects</span><span class="p">:</span> <span class="n">pstype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Figures the % of total of each landuse feature for one location.</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        buffer_data: The land use values at a given radius</span>
<span class="sd">        location: The survey location of interest</span>
<span class="sd">    </span>
<span class="sd">    Returns:</span>
<span class="sd">        A pandas series of the % of total for each landuse feature in the index</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># try to reitrieve the land use data for a location</span>
        <span class="n">location_data</span> <span class="o">=</span> <span class="n">buffer_data</span><span class="p">[</span><span class="n">buffer_data</span><span class="o">.</span><span class="n">location</span> <span class="o">==</span> <span class="n">location</span><span class="p">][</span><span class="n">label</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The location data could not retrieved&quot;</span><span class="p">)</span>
        <span class="k">raise</span>
    
    <span class="c1"># the sum of all land use features in the radius</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">location_data</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="c1"># the amount of the area attributed to water (lakes and rivers)</span>
    <span class="n">water</span> <span class="o">=</span> <span class="n">location_data</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s2">&quot;water&quot;</span><span class="p">]</span>   
    <span class="c1"># divide the land_use values by the total minus the amount attributed to water</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">location_data</span><span class="o">/</span><span class="p">(</span><span class="n">total</span><span class="o">-</span><span class="n">water</span><span class="p">)</span>
    <span class="c1"># name the series</span>
    <span class="n">results</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">location</span>
    <span class="c1"># the intersects and road-lengths are calculated seprately</span>
    <span class="c1"># if add_intersects and roads is true, attach them to the</span>
    <span class="c1"># the land use values</span>
    <span class="k">if</span> <span class="n">add_intersects_roads</span><span class="p">:</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">addIntersectsToBuffer</span><span class="p">(</span><span class="n">buffer_data</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">intersects</span><span class="o">=</span><span class="n">intersects</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">addRoadLengthToBuffer</span><span class="p">(</span><span class="n">buffer_data</span><span class="o">=</span><span class="n">results</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">road_lengths</span><span class="o">=</span><span class="n">road_lengths</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">results</span>

<span class="k">class</span> <span class="nc">BufferData</span><span class="p">:</span>
    <span class="n">a_col</span><span class="o">=</span><span class="s2">&quot;AS18_27&quot;</span>
    <span class="n">new_col</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span>
    <span class="n">exclude_these</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">label_keys</span> <span class="o">=</span> <span class="n">new_label_keys</span>
    <span class="n">beach_data</span> <span class="o">=</span> <span class="n">dfBeaches</span>
    
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">locations</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer_data</span> <span class="o">=</span> <span class="n">combineLandUseFeatures</span><span class="p">(</span><span class="n">buffer_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">a_col</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a_col</span><span class="p">,</span> <span class="n">new_col</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">new_col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_buffer</span> <span class="o">=</span> <span class="n">adjustLandUse</span><span class="p">(</span><span class="n">buffer_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_data</span><span class="p">,</span> <span class="n">exclude_these</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_these</span><span class="p">,</span> <span class="n">locations</span><span class="o">=</span><span class="n">locations</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pctLandUse</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locations</span> <span class="o">=</span> <span class="n">locations</span>
        
    <span class="k">def</span> <span class="nf">percentLandUse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pctLandUse</span><span class="p">,</span> <span class="n">pdtype</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pctLandUse</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adjusted_buffer</span><span class="p">,</span> <span class="n">pdtype</span><span class="p">):</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">road_lengths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beach_data</span><span class="o">.</span><span class="n">streets</span>
            <span class="n">intersects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beach_data</span><span class="o">.</span><span class="n">intersects</span>
            <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locations</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">calculatePercentLandUse</span><span class="p">(</span><span class="n">buffer_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">adjusted_buffer</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">road_lengths</span><span class="o">=</span><span class="n">road_lengths</span><span class="p">,</span> <span class="n">intersects</span><span class="o">=</span><span class="n">intersects</span><span class="p">)</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">pctLandUse</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pctLandUse</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="bielersee">
<h1><span class="section-number">1. </span>Bielersee<a class="headerlink" href="#bielersee" title="Permalink to this headline">#</a></h1>
<p><strong>The hypothesis of ρ</strong></p>
<p><span class="math notranslate nohighlight">\(H_{0}\)</span>: There is no monotonic association between the two variables</p>
<p>Statistical significance is defined as a very unlikely outcome under the null hypothesis, for this report unlikely is defined as less than 5% chance or p &lt; 0.05 that the null hypotheses will be rejected even though it is true. Spearmans ρ is implemented using <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.spearmanr.html">SciPy</a> on <a class="reference external" href="https://jupyter.org/">Jupyter Lab</a></p>
<p>The data is beach litter data collected during a national survey of lakes and rivers in Switzerland, <a class="reference external" href="https://hammerdirt-analyst.github.io/IQAASL-End-0f-Sampling-2021/titlepage_de.html">IQAASL</a>. Standard MSFD/OSPAR protocols were followed within geographic limitations.</p>
<p><strong>Using ρ</strong></p>
<p>Land use data for each survey location was collected by creating buffer-zones around each survey location at radiuses from 1.5 - 5km and 10km and sectioning layers of the <a class="reference external" href="https://www.bfs.admin.ch/bfs/en/home/services/geostat/swiss-federal-statistics-geodata/land-use-cover-suitability/swiss-land-use-statistics.html#geodata__content_bfs_en_home_dienstleistungen_geostat_geodaten-bundesstatistik_boden-nutzung-bedeckung-eignung_arealstatistik-schweiz_jcr_content_par_tabs">Swiss Statistical Survey</a>, the complete process is defined here <a class="reference external" href="https://hammerdirt-analyst.github.io/IQAASL-End-0f-Sampling-2021/land_use_correlation.htmlwith"><em>The land use profile</em></a>.</p>
<p>The land use is designated For every 100m² of the country using satellite images. There are 27 different possible categories for each 100m², a buffer zone with radius of 1500m  has an area ( <span class="math notranslate nohighlight">\(\pi r^{2}\)</span> ) of 7,068,583m² or <span class="math notranslate nohighlight">\(\approxeq\)</span> 700 100m squares. In Switzerland the width of the lake shore is fairly small, a survey of 100m x 50m would be considered fairly large. For the data in this report the median survey length was 52 meters.</p>
<p>However, there are over three hundred samples in the data set. Each sample has between zero and 100 different objects, each object has its own count. In total there were over 50,000 items collected, identified and counted in the 12 month period. Each sample is recorded as pieces of trash per meter and quantity.</p>
<div class="section" id="esitmating-landuse">
<h2><span class="section-number">1.1. </span>Esitmating landuse<a class="headerlink" href="#esitmating-landuse" title="Permalink to this headline">#</a></h2>
<p>Once the data is exported from the maplayer the features were grouped by use. For example all types of buildings were grouped together, the different aggricultural uses were grouped together as well as woodlands and water features.</p>
<p><em><strong>Below:</strong> The land use categories and the corresponding groups. Notice that <code class="docutils literal notranslate"><span class="pre">industrial</span></code> is the only group that has one land use component. The numbers in the square brackets are the original designation from the map layer. For example there were five different types of buildings desginated in the map layer</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="n">group_parts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;buildings&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">9</span><span class="p">],</span>
                   <span class="s1">&#39;industrial&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">],</span>              
                   <span class="s1">&#39;trans&#39;</span><span class="p">:[</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">],</span>
                   <span class="s1">&#39;recreation&#39;</span><span class="p">:[</span><span class="mi">10</span><span class="p">],</span>
                   <span class="s1">&#39;agriculture&#39;</span><span class="p">:[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span><span class="p">],</span>
                   <span class="s1">&#39;woods&#39;</span><span class="p">:[</span><span class="mi">17</span><span class="p">,</span><span class="mi">19</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">21</span><span class="p">,</span><span class="mi">22</span><span class="p">],</span>
                   <span class="s1">&#39;water&#39;</span><span class="p">:[</span><span class="mi">23</span><span class="p">,</span><span class="mi">24</span><span class="p">],</span>
                   <span class="s1">&#39;unproductive&#39;</span><span class="p">:[</span><span class="mi">25</span><span class="p">,</span><span class="mi">26</span><span class="p">,</span><span class="mi">27</span><span class="p">]</span>
                  <span class="p">}</span>
</pre></div>
</div>
<div class="section" id="estimating-the-road-and-river-network">
<h3><span class="section-number">1.1.1. </span>Estimating the road and river network<a class="headerlink" href="#estimating-the-road-and-river-network" title="Permalink to this headline">#</a></h3>
<p>The values for the road and river network with a given radius are defined separately. The road network is the sum of the lengths of all roads, footpaths, freeways and forest roads within the area of interest. Note that the area attributed to roads given by the default map layer does not provide the same value. This is because of the way land use is estimated for each 100 m square. For example, if the center of a 100 m square has a road in it then the entire 100² m is attributed to the category roads (or railways). As a result only a portion of the road network is accounted for.</p>
<p>To calculate the road network another map layer is used. The polylines for the roads are disolved into a single line, and the length of that line (divided by 1000) is the number of kilometers of road network for the area in question.</p>
<p>The river network, labeled as <em>intersections</em> is only valid for lake samples. The intersections are the number of rivers/streams/canals that enter the lake within the given radius. Alternate methods (inlcuding length of the river network) are addressed in a later section.</p>
<p><strong>The land use for one location: example &#64; 1500 m</strong></p>
<p>To calculate the landuse at one location for one radius. Requires indentifying the location of interest and the relevant file with the buffer data. These are minimum arguments to instantiate a <code class="docutils literal notranslate"><span class="pre">BufferData</span></code> object. Once the object is initiated the</p>
<p>For each location an adjusted buffer object is created. An adjusted-buffer-object is a datafram with between 690-720 rows. Each row corresponds to the landuse attribution for one of the 100 m squares within the 1500 m radius. The aggregated groups are created when the object is iniated. The aggregation or grouping can be changed by replacing the <code class="docutils literal notranslate"><span class="pre">BufferData</span></code> default grouping dictionary with a new dictionary.</p>
<p>The adjusted-buffer object can be used to exclude columns or values that are not of interest. If no columns are excluded the adjusted-buffer object contains all the landuse attributes for the location in question.</p>
<p><em><strong>Below:</strong> Creating a buffer object for one location and retrieving the % of land use for the defined categories</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># location of interest</span>
<span class="n">location</span> <span class="o">=</span> <span class="s2">&quot;hauterive-petite-plage&quot;</span>

<span class="c1"># the landuse values at a radius of 1500 m</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;resources/buffer_output/luse_1500.csv&quot;</span>

<span class="c1"># initiate a BufferData object</span>
<span class="n">haut_rive_land_use</span> <span class="o">=</span> <span class="n">BufferData</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">locations</span><span class="o">=</span><span class="p">[</span><span class="n">location</span><span class="p">])</span>

<span class="c1"># call the method &lt;percentLandUse&gt; of the BufferData class</span>
<span class="n">haut_rive_percent_land_use</span> <span class="o">=</span> <span class="n">haut_rive_land_use</span><span class="o">.</span><span class="n">percentLandUse</span><span class="p">()</span>    
</pre></div>
</div>
<p><strong>The land use for more than one location: example &#64; 1500 m Bielersee</strong></p>
<p>A correlation requires more than one set of values. To get the buffer data for a collection of locations, lets say a lake, suppy a list of locations to the <code class="docutils literal notranslate"><span class="pre">BufferData</span></code> class.</p>
<p><em><strong>Below:</strong> Creating a buffer object for all the locations on a lake and retrieving the % of land use for the defined categories</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># all the locations on Bielersee</span>
<span class="n">locations</span> <span class="o">=</span> <span class="n">dfBeaches</span><span class="p">[</span><span class="n">dfBeaches</span><span class="o">.</span><span class="n">water_name_slug</span> <span class="o">==</span> <span class="s1">&#39;bielersee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># use the same buffer data</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;resources/buffer_output/luse_1500.csv&quot;</span>

<span class="c1"># initiate a BufferData object</span>
<span class="n">bielersee_landuse</span> <span class="o">=</span> <span class="n">BufferData</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">locations</span><span class="o">=</span><span class="n">locations</span><span class="p">)</span>

<span class="c1"># call the method &lt;percentLandUse&gt; of the BufferData class</span>
<span class="c1"># calling T on the results puts the locations in the index and the landuse labels in the columns</span>
<span class="n">neunburgersee_percent_land_use</span> <span class="o">=</span> <span class="n">bielersee_landuse</span><span class="o">.</span><span class="n">percentLandUse</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="map-of-survey-locations-and-aggregated-results">
<h2><span class="section-number">1.2. </span>Map of survey locations and aggregated results<a class="headerlink" href="#map-of-survey-locations-and-aggregated-results" title="Permalink to this headline">#</a></h2>
<div class="figure align-default" id="bielersee-map">
<img alt="_images/bielersee_city_labels.jpeg" src="_images/bielersee_city_labels.jpeg" />
<p class="caption"><span class="caption-number">Fig. 1.1 </span><span class="caption-text"><code class="docutils literal notranslate"> </code></span><a class="headerlink" href="#bielersee-map" title="Permalink to this image">#</a></p>
</div>
<p><a class="reference internal" href="#bielersee-map"><span class="std std-numref">figure 1.1:</span></a> The survey locations and aggregated municipal results.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">locations</span> <span class="o">=</span> <span class="n">dfBeaches</span><span class="p">[</span><span class="n">dfBeaches</span><span class="o">.</span><span class="n">water_name_slug</span> <span class="o">==</span> <span class="s1">&#39;bielersee&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;resources/buffer_output/luse_1500.csv&quot;</span>

<span class="n">bielersee_landuse</span> <span class="o">=</span> <span class="n">BufferData</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">locations</span><span class="o">=</span><span class="n">locations</span><span class="p">)</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">bielersee_landuse</span><span class="o">.</span><span class="n">percentLandUse</span><span class="p">()</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">display_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span>  <span class="s2">&quot;industrial&quot;</span><span class="p">,</span> <span class="s2">&quot;roads&quot;</span><span class="p">,</span> <span class="s2">&quot;recreation&quot;</span><span class="p">,</span> <span class="s2">&quot;agriculture&quot;</span><span class="p">,</span><span class="s2">&quot;woods&quot;</span><span class="p">,</span> <span class="s2">&quot;intersects&quot;</span><span class="p">,</span> <span class="s2">&quot;unproductive&quot;</span><span class="p">]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">display_columns</span><span class="p">]</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span><span class="n">table_css_styles</span><span class="p">)</span>

<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;bielersee_luse&quot;</span><span class="p">,</span> <span class="n">res</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="figure align-default" id="bielersee-luse">
<div class="output text_html"><style type="text/css">
#T_0ee31 tr:nth-child(even) {
  background-color: rgba(139, 69, 19, 0.08);
}
#T_0ee31 tr:nth-child(odd) {
  background: #FFF;
}
#T_0ee31 tr {
  font-size: 12px;
}
#T_0ee31 th:nth-child(1) {
  background-color: #FFF;
}
</style>
<table id="T_0ee31">
  <thead>
    <tr>
      <th class="index_name level0" >label</th>
      <th id="T_0ee31_level0_col0" class="col_heading level0 col0" >buildings</th>
      <th id="T_0ee31_level0_col1" class="col_heading level0 col1" >industrial</th>
      <th id="T_0ee31_level0_col2" class="col_heading level0 col2" >roads</th>
      <th id="T_0ee31_level0_col3" class="col_heading level0 col3" >recreation</th>
      <th id="T_0ee31_level0_col4" class="col_heading level0 col4" >agriculture</th>
      <th id="T_0ee31_level0_col5" class="col_heading level0 col5" >woods</th>
      <th id="T_0ee31_level0_col6" class="col_heading level0 col6" >intersects</th>
      <th id="T_0ee31_level0_col7" class="col_heading level0 col7" >unproductive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_0ee31_level0_row0" class="row_heading level0 row0" >bielersee_vinelz_fankhausers</th>
      <td id="T_0ee31_row0_col0" class="data row0 col0" >0.155</td>
      <td id="T_0ee31_row0_col1" class="data row0 col1" >0.008</td>
      <td id="T_0ee31_row0_col2" class="data row0 col2" >58.500</td>
      <td id="T_0ee31_row0_col3" class="data row0 col3" >0.034</td>
      <td id="T_0ee31_row0_col4" class="data row0 col4" >0.568</td>
      <td id="T_0ee31_row0_col5" class="data row0 col5" >0.134</td>
      <td id="T_0ee31_row0_col6" class="data row0 col6" >5.000</td>
      <td id="T_0ee31_row0_col7" class="data row0 col7" >0.063</td>
    </tr>
    <tr>
      <th id="T_0ee31_level0_row1" class="row_heading level0 row1" >camp-des-peches</th>
      <td id="T_0ee31_row1_col0" class="data row1 col0" >0.168</td>
      <td id="T_0ee31_row1_col1" class="data row1 col1" >0.024</td>
      <td id="T_0ee31_row1_col2" class="data row1 col2" >74.200</td>
      <td id="T_0ee31_row1_col3" class="data row1 col3" >0.053</td>
      <td id="T_0ee31_row1_col4" class="data row1 col4" >0.513</td>
      <td id="T_0ee31_row1_col5" class="data row1 col5" >0.141</td>
      <td id="T_0ee31_row1_col6" class="data row1 col6" >8.000</td>
      <td id="T_0ee31_row1_col7" class="data row1 col7" >0.004</td>
    </tr>
    <tr>
      <th id="T_0ee31_level0_row2" class="row_heading level0 row2" >erlach-camping-strand</th>
      <td id="T_0ee31_row2_col0" class="data row2 col0" >0.136</td>
      <td id="T_0ee31_row2_col1" class="data row2 col1" >0.011</td>
      <td id="T_0ee31_row2_col2" class="data row2 col2" >38.800</td>
      <td id="T_0ee31_row2_col3" class="data row2 col3" >0.057</td>
      <td id="T_0ee31_row2_col4" class="data row2 col4" >0.430</td>
      <td id="T_0ee31_row2_col5" class="data row2 col5" >0.186</td>
      <td id="T_0ee31_row2_col6" class="data row2 col6" >7.000</td>
      <td id="T_0ee31_row2_col7" class="data row2 col7" >0.133</td>
    </tr>
    <tr>
      <th id="T_0ee31_level0_row3" class="row_heading level0 row3" >gals-reserve</th>
      <td id="T_0ee31_row3_col0" class="data row3 col0" >0.113</td>
      <td id="T_0ee31_row3_col1" class="data row3 col1" >0.009</td>
      <td id="T_0ee31_row3_col2" class="data row3 col2" >58.500</td>
      <td id="T_0ee31_row3_col3" class="data row3 col3" >0.055</td>
      <td id="T_0ee31_row3_col4" class="data row3 col4" >0.443</td>
      <td id="T_0ee31_row3_col5" class="data row3 col5" >0.300</td>
      <td id="T_0ee31_row3_col6" class="data row3 col6" >7.000</td>
      <td id="T_0ee31_row3_col7" class="data row3 col7" >0.028</td>
    </tr>
    <tr>
      <th id="T_0ee31_level0_row4" class="row_heading level0 row4" >ligerz-strand</th>
      <td id="T_0ee31_row4_col0" class="data row4 col0" >0.118</td>
      <td id="T_0ee31_row4_col1" class="data row4 col1" >nan</td>
      <td id="T_0ee31_row4_col2" class="data row4 col2" >50.800</td>
      <td id="T_0ee31_row4_col3" class="data row4 col3" >0.018</td>
      <td id="T_0ee31_row4_col4" class="data row4 col4" >0.366</td>
      <td id="T_0ee31_row4_col5" class="data row4 col5" >0.416</td>
      <td id="T_0ee31_row4_col6" class="data row4 col6" >3.000</td>
      <td id="T_0ee31_row4_col7" class="data row4 col7" >0.029</td>
    </tr>
    <tr>
      <th id="T_0ee31_level0_row5" class="row_heading level0 row5" >luscherz-plage</th>
      <td id="T_0ee31_row5_col0" class="data row5 col0" >0.079</td>
      <td id="T_0ee31_row5_col1" class="data row5 col1" >nan</td>
      <td id="T_0ee31_row5_col2" class="data row5 col2" >37.300</td>
      <td id="T_0ee31_row5_col3" class="data row5 col3" >0.009</td>
      <td id="T_0ee31_row5_col4" class="data row5 col4" >0.269</td>
      <td id="T_0ee31_row5_col5" class="data row5 col5" >0.601</td>
      <td id="T_0ee31_row5_col6" class="data row5 col6" >6.000</td>
      <td id="T_0ee31_row5_col7" class="data row5 col7" >0.015</td>
    </tr>
    <tr>
      <th id="T_0ee31_level0_row6" class="row_heading level0 row6" >luscherz-two</th>
      <td id="T_0ee31_row6_col0" class="data row6 col0" >0.069</td>
      <td id="T_0ee31_row6_col1" class="data row6 col1" >nan</td>
      <td id="T_0ee31_row6_col2" class="data row6 col2" >39.700</td>
      <td id="T_0ee31_row6_col3" class="data row6 col3" >0.008</td>
      <td id="T_0ee31_row6_col4" class="data row6 col4" >0.271</td>
      <td id="T_0ee31_row6_col5" class="data row6 col5" >0.613</td>
      <td id="T_0ee31_row6_col6" class="data row6 col6" >6.000</td>
      <td id="T_0ee31_row6_col7" class="data row6 col7" >0.014</td>
    </tr>
    <tr>
      <th id="T_0ee31_level0_row7" class="row_heading level0 row7" >mullermatte</th>
      <td id="T_0ee31_row7_col0" class="data row7 col0" >0.258</td>
      <td id="T_0ee31_row7_col1" class="data row7 col1" >0.022</td>
      <td id="T_0ee31_row7_col2" class="data row7 col2" >109.600</td>
      <td id="T_0ee31_row7_col3" class="data row7 col3" >0.069</td>
      <td id="T_0ee31_row7_col4" class="data row7 col4" >0.084</td>
      <td id="T_0ee31_row7_col5" class="data row7 col5" >0.435</td>
      <td id="T_0ee31_row7_col6" class="data row7 col6" >3.000</td>
      <td id="T_0ee31_row7_col7" class="data row7 col7" >0.007</td>
    </tr>
    <tr>
      <th id="T_0ee31_level0_row8" class="row_heading level0 row8" >nidau-strand</th>
      <td id="T_0ee31_row8_col0" class="data row8 col0" >0.383</td>
      <td id="T_0ee31_row8_col1" class="data row8 col1" >0.040</td>
      <td id="T_0ee31_row8_col2" class="data row8 col2" >119.600</td>
      <td id="T_0ee31_row8_col3" class="data row8 col3" >0.099</td>
      <td id="T_0ee31_row8_col4" class="data row8 col4" >0.099</td>
      <td id="T_0ee31_row8_col5" class="data row8 col5" >0.200</td>
      <td id="T_0ee31_row8_col6" class="data row8 col6" >3.000</td>
      <td id="T_0ee31_row8_col7" class="data row8 col7" >0.008</td>
    </tr>
    <tr>
      <th id="T_0ee31_level0_row9" class="row_heading level0 row9" >strandboden-biel</th>
      <td id="T_0ee31_row9_col0" class="data row9 col0" >0.346</td>
      <td id="T_0ee31_row9_col1" class="data row9 col1" >0.025</td>
      <td id="T_0ee31_row9_col2" class="data row9 col2" >124.400</td>
      <td id="T_0ee31_row9_col3" class="data row9 col3" >0.079</td>
      <td id="T_0ee31_row9_col4" class="data row9 col4" >0.048</td>
      <td id="T_0ee31_row9_col5" class="data row9 col5" >0.341</td>
      <td id="T_0ee31_row9_col6" class="data row9 col6" >3.000</td>
      <td id="T_0ee31_row9_col7" class="data row9 col7" >0.007</td>
    </tr>
  </tbody>
</table>
</div><p class="caption"><span class="caption-number">Fig. 1.2 </span><span class="caption-text"><code class="docutils literal notranslate"> </code></span><a class="headerlink" href="#bielersee-luse" title="Permalink to this image">#</a></p>
</div>
<p><a class="reference internal" href="#bielersee-luse"><span class="std std-numref">figure 1.2:</span></a> The percent of total landuse attributed to each land use feature for each survey location on Bielersee. <strong>Intersects</strong> = the number of discharges within 1 500 m of the survey location. <strong>Roads</strong> = the length of all roads, highways and pedestrian trails within 1500 m of the survey location.</p>
</div>
<div class="section" id="for-a-collection-of-locations">
<h2><span class="section-number">1.3. </span><em>Ρ</em> for a collection of locations<a class="headerlink" href="#for-a-collection-of-locations" title="Permalink to this headline">#</a></h2>
<p>Prior to calculating ρ for a set of survey results there are some important considerations.</p>
<ol class="arabic simple">
<li><p>Does the hypothesis correspond to the requirements of the analysis?</p></li>
<li><p>How many samples are available?</p></li>
<li><p>Are the locations in the set of data related in some way?</p></li>
<li><p>Are the results normalized or standaridized so that they are comparable?</p></li>
<li><p>What indications (if any) do the results suggest prior to conducting the test?</p></li>
</ol>
<p>In our current use case the hypothesis (or the rejection of the null hypothesis) corresponds to our observations in the field for some objects. For example, it appears that more tabaco and snack related objects are found in greater density at locations that are in urban areas. Other objects, such as expanded polystyrene or fragmented plastics appear to be indentified at more or less the same density indifferent of the survey location (there are a few exceptions).</p>
<p>The results are normalized to <i>number of objects per meter of shoreline (p/m)</i>. This allows the comparison of survey results between survey locations of different sizes. By normalizing the results and considering locations that have common elements (lake or river or catchment area) the number of samples can be maximized.</p>
<p>In cases of less than 500 samples a permutation test is conducted to calculate the null distribution of the statistic (the P value). <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.spearmanr.html">scipy spearmans</a></p>
<p><strong>What about zero?</strong></p>
<p>It is necessary to include all samples, including those where none of the objects of interest were found. In the default data set each sample includes all the valid codes that could have been identified. If the surveyor did not enter any data for a particular code then the quantity of that code for that sample is automatically recorded as zero.</p>
<div class="section" id="definition-of-codes-of-interest">
<h3><span class="section-number">1.3.1. </span>Definition of codes of interest<a class="headerlink" href="#definition-of-codes-of-interest" title="Permalink to this headline">#</a></h3>
<p>The codes of interest are the objects for which we would like to determine a correlation. It is possible to just simply test all the codes for a set of survey results. However, running the tests on large data-sets can take time, and the generalization of any results is unreliable at best in the abscence of supporting information.</p>
<p>In this document we have defined codes of interest as those codes that meet criteria based on quantity or frequency:</p>
<ol class="arabic simple">
<li><p>Consider only codes whose total quantity is above a certain threshhold</p></li>
<li><p>Consider only codes that were indentified (quantity &gt; 0) in a certain number or ratio of samples</p></li>
</ol>
<p><em><strong>Below:</strong> Using the fail rate or quantity to define the codes of interest.</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># defining abundance and frequency</span>
<span class="c1"># create the feature data</span>
<span class="c1"># instantiate the survey results class</span>
<span class="n">fdx</span> <span class="o">=</span> <span class="n">SurveyResults</span><span class="p">()</span>

<span class="c1"># call the survey results method with default arguments</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fdx</span><span class="o">.</span><span class="n">surveyResults</span><span class="p">()</span>

<span class="c1"># define a threshold for the two parameters</span>
<span class="n">abundance</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">fail</span> <span class="o">=</span> <span class="mf">.25</span>

<span class="c1"># abundance</span>
<span class="n">codes</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">abundant</span> <span class="o">=</span> <span class="n">codes</span><span class="p">[</span><span class="n">codes</span> <span class="o">&gt;</span> <span class="n">abundance</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># frequency</span>
<span class="n">codes_fail</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">loc_date</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">codes_fail</span> <span class="o">=</span> <span class="n">fail_rates</span><span class="p">[</span><span class="n">fail_rates</span> <span class="o">&gt;</span> <span class="n">fail</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="section" id="ranked-correlation-of-the-most-common-objects-on-bielersee">
<h3><span class="section-number">1.3.2. </span>Ranked correlation of the most common objects on Bielersee<a class="headerlink" href="#ranked-correlation-of-the-most-common-objects-on-bielersee" title="Permalink to this headline">#</a></h3>
<p>To determine the ranked correlation of object density to landuse feature there are several steps that need to be accomplished. Some have been explained previously (<code class="docutils literal notranslate"><span class="pre">BufferData</span></code>, objects of interest). The goal is to compare the density of an object to a particular land use value. How this is achieved depends on your setup. For the data in this repo we use the following process:</p>
<ol class="arabic simple">
<li><p>Select a buffer radius</p></li>
<li><p>Select a collection of related sample results</p></li>
<li><p>Construct buffer data</p></li>
<li><p>Format sample results</p></li>
<li><p>Indentify codes of interest</p></li>
<li><p>Make 2d array of code result and land use value ie. [[code_results], [land_use_%]] for each code and landuse attribute</p></li>
<li><p>Pass the 2d array to scipy.stats.spearmanr</p></li>
<li><p>Where samples are less than 500 run a permutation test for the null distribution</p></li>
</ol>
<p>Classes and methods have been defined for each step click below to see the methods.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">timer</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">wrapper</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
        <span class="n">run_time</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Finished </span><span class="si">{}</span><span class="s2"> in </span><span class="si">{}</span><span class="s2"> secs&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">run_time</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">return</span> <span class="n">wrapper</span>

<span class="k">def</span> <span class="nf">assignLanduseValue</span><span class="p">(</span><span class="n">sample</span><span class="p">:</span> <span class="n">pstype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">land_use</span><span class="p">:</span> <span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
    <span class="c1"># returns the requested value of land use from the sample</span>
    <span class="c1"># if the requested landuse value is not present in the buffer</span>
    <span class="c1"># zero is returned</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="n">sample</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">land_use</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="k">return</span> <span class="n">result</span>

<span class="k">def</span> <span class="nf">cleanSurveyResults</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
    <span class="c1"># performs data cleaning operations on the</span>
    <span class="c1"># default data</span>
    
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;loc_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">location</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">]))</span>
    <span class="n">data</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;date&quot;</span><span class="p">])</span>
    
    <span class="c1"># get rid of microplastics</span>
    <span class="n">mcr</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">groupname</span> <span class="o">==</span> <span class="s2">&quot;micro plastics (&lt; 5mm)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    
    <span class="c1"># replace the bad code</span>
    <span class="n">data</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;G207&#39;</span><span class="p">,</span> <span class="s1">&#39;G208&#39;</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="o">~</span><span class="n">data</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">mcr</span><span class="p">)]</span>
    
    <span class="c1"># walensee has no landuse values</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">water_name_slug</span> <span class="o">!=</span> <span class="s1">&#39;walensee&#39;</span><span class="p">]</span>   
    
    <span class="k">return</span> <span class="n">data</span>

<span class="k">class</span> <span class="nc">SurveyResults</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Creates a dataframe from a valid filename. Assigns the column names and defines a list of</span>
<span class="sd">    codes and locations that can be used in the CodeData class.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">file_name</span> <span class="o">=</span> <span class="s1">&#39;resources/checked_sdata_eos_2020_21.csv&#39;</span>
    <span class="n">columns_to_keep</span><span class="o">=</span><span class="p">[</span>
        <span class="s1">&#39;loc_date&#39;</span><span class="p">,</span>
        <span class="s1">&#39;location&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;river_bassin&#39;</span><span class="p">,</span>
        <span class="s1">&#39;water_name_slug&#39;</span><span class="p">,</span>
        <span class="s1">&#39;city&#39;</span><span class="p">,</span>
        <span class="s1">&#39;w_t&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;intersects&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;code&#39;</span><span class="p">,</span> 
        <span class="s1">&#39;pcs_m&#39;</span><span class="p">,</span>
        <span class="s1">&#39;quantity&#39;</span>
    <span class="p">]</span>
        
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">clean_data</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">columns</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">columns_to_keep</span><span class="p">,</span> <span class="n">w_t</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dfx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_results</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locations</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valid_codes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clean_data</span> <span class="o">=</span> <span class="n">clean_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w_t</span> <span class="o">=</span> <span class="n">w_t</span>
        
    <span class="k">def</span> <span class="nf">validCodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># creates a list of unique code values for the data set    </span>
        <span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">df_results</span><span class="p">,</span> <span class="n">pdtype</span><span class="p">),</span>
            <span class="s2">&quot;code&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_results</span><span class="o">.</span><span class="n">columns</span>
        <span class="p">]</span>

        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>

            <span class="k">try</span><span class="p">:</span>
                <span class="n">valid_codes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_results</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There was an error retrieving the unique code names, self.df.code.unique() failed.&quot;</span><span class="p">)</span>
                <span class="k">raise</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">valid_codes</span> <span class="o">=</span> <span class="n">valid_codes</span>
                
        
    <span class="k">def</span> <span class="nf">surveyResults</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="c1"># if this method has been called already</span>
        <span class="c1"># return the result</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_results</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_results</span>
        
        <span class="c1"># for the default data self.clean data must be called        </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clean_data</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="n">cleanSurveyResults</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dfx</span><span class="p">)</span>
            
        <span class="c1"># if the data is clean then if can be used directly</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfx</span>
        
        <span class="c1"># filter the data by the variable w_t</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_t</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="n">fd</span><span class="p">[</span><span class="n">fd</span><span class="o">.</span><span class="n">w_t</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">w_t</span><span class="p">]</span>            
         
        <span class="c1"># keep only the required columns</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">fd</span> <span class="o">=</span> <span class="n">fd</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
        
        <span class="c1"># assign the survey results to the class attribute</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">df_results</span> <span class="o">=</span> <span class="n">fd</span>
        
        <span class="c1"># define the list of codes in this df</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">validCodes</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_results</span>
    
    <span class="k">def</span> <span class="nf">surveyLocations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">locations</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">locations</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_results</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">locations</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dfResults</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">locations</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;There is no survey data loaded&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>    

<span class="k">class</span> <span class="nc">BufferData</span><span class="p">:</span>
    <span class="n">a_col</span><span class="o">=</span><span class="s2">&quot;AS18_27&quot;</span>
    <span class="n">new_col</span> <span class="o">=</span> <span class="s2">&quot;label&quot;</span>
    <span class="n">exclude_these</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">label_keys</span> <span class="o">=</span> <span class="n">new_label_keys</span>
    <span class="n">beach_data</span> <span class="o">=</span> <span class="n">dfBeaches</span>
    
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">locations</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer_data</span> <span class="o">=</span> <span class="n">combineLandUseFeatures</span><span class="p">(</span><span class="n">buffer_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">,</span> <span class="n">a_col</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a_col</span><span class="p">,</span> <span class="n">new_col</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">new_col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">adjusted_buffer</span> <span class="o">=</span> <span class="n">adjustLandUse</span><span class="p">(</span><span class="n">buffer_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer_data</span><span class="p">,</span> <span class="n">exclude_these</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">exclude_these</span><span class="p">,</span> <span class="n">locations</span><span class="o">=</span><span class="n">locations</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pctLandUse</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">locations</span> <span class="o">=</span> <span class="n">locations</span>
        
    <span class="k">def</span> <span class="nf">percentLandUse</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pctLandUse</span><span class="p">,</span> <span class="n">pdtype</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pctLandUse</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adjusted_buffer</span><span class="p">,</span> <span class="n">pdtype</span><span class="p">):</span>
            <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">road_lengths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beach_data</span><span class="o">.</span><span class="n">streets</span>
            <span class="n">intersects</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">beach_data</span><span class="o">.</span><span class="n">intersects</span>
            <span class="k">for</span> <span class="n">location</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">locations</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">calculatePercentLandUse</span><span class="p">(</span><span class="n">buffer_data</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">adjusted_buffer</span><span class="p">,</span> <span class="n">location</span><span class="o">=</span><span class="n">location</span><span class="p">,</span> <span class="n">road_lengths</span><span class="o">=</span><span class="n">road_lengths</span><span class="p">,</span> <span class="n">intersects</span><span class="o">=</span><span class="n">intersects</span><span class="p">)</span>
                <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">pctLandUse</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">results</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pctLandUse</span>
    
<span class="k">class</span> <span class="nc">CodeData</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code_data</span> <span class="o">=</span> <span class="kc">None</span>       
    
    <span class="k">def</span> <span class="nf">makeCodeData</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-&gt;</span><span class="n">pdtype</span><span class="p">:</span>
        
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">code_data</span><span class="p">,</span> <span class="n">pdtype</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_data</span>        
        
        <span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">pdtype</span><span class="p">)</span>            
        <span class="p">]</span>
        
        <span class="k">if</span> <span class="nb">all</span><span class="p">(</span><span class="n">conditions</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">code_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">code</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">code</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_data</span>    
    
<span class="k">class</span> <span class="nc">CodeResults</span><span class="p">:</span>   
        
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code_data</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> 
                 <span class="n">method</span><span class="p">:</span> <span class="n">callable</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>        
        
        <span class="bp">self</span><span class="o">.</span><span class="n">code_data</span> <span class="o">=</span> <span class="n">code_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">buffer</span> <span class="o">=</span> <span class="n">buffer</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">code</span> <span class="o">=</span> <span class="n">code</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">method</span> <span class="o">=</span> <span class="n">method</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    
        
    <span class="k">def</span> <span class="nf">landuseValueForOneCondition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">land_use</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">locations</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">):</span>
        
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_data</span><span class="o">.</span><span class="n">pcs_m</span><span class="o">.</span><span class="n">values</span>      
        <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">buffer</span><span class="p">[</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">land_use</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">code_data</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">values</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span>
    
    <span class="k">def</span> <span class="nf">rhoForALAndUseCategory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
        <span class="c1"># returns the asymptotic results if ranking based method is used        </span>
        <span class="n">c</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">c</span><span class="p">,</span> <span class="n">p</span>
    
    <span class="k">def</span> <span class="nf">getRho</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="c1"># assigns y from self        </span>
        <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">method</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
                       
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">correlation</span>            
        
    <span class="k">def</span> <span class="nf">exactPValueForRho</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="c1"># perform a permutation test instead of relying on </span>
        <span class="c1"># the asymptotic p-value. Only one of the two inputs </span>
        <span class="c1"># needs to be shuffled.</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,)</span> <span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">getRho</span><span class="p">,</span> <span class="n">permutation_type</span><span class="o">=</span><span class="s1">&#39;pairings&#39;</span><span class="p">,</span> <span class="n">n_resamples</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">p</span>


<span class="k">def</span> <span class="nf">makeBufferObject</span><span class="p">(</span><span class="n">file_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;resources/buffer_output/luse_1500.csv&quot;</span><span class="p">,</span> <span class="n">buffer_locations</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">pdtype</span><span class="p">,</span> <span class="n">pdtype</span><span class="p">):</span>
    <span class="c1"># Makes a buffer object by calling the BufferData class</span>
    <span class="c1"># calls the percentLandUse method and fills Nan values</span>
    <span class="c1"># returns the buffer_data object and pct land use values</span>
    
    <span class="n">buffer_data</span> <span class="o">=</span> <span class="n">BufferData</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">locations</span><span class="o">=</span><span class="n">buffer_locations</span><span class="p">)</span>
    <span class="n">pct_vals</span> <span class="o">=</span> <span class="n">buffer_data</span><span class="o">.</span><span class="n">percentLandUse</span><span class="p">()</span>
    <span class="n">pct_vals</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">buffer_data</span><span class="p">,</span> <span class="n">pct_vals</span>

<span class="k">def</span> <span class="nf">asymptoticAndExactPvalues</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">buffer</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">code</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">land_use</span><span class="p">:</span> <span class="s1">&#39;str&#39;</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    
    <span class="n">code_data</span> <span class="o">=</span> <span class="n">CodeData</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">)</span><span class="o">.</span><span class="n">makeCodeData</span><span class="p">()</span>
    <span class="n">code_results</span> <span class="o">=</span> <span class="n">CodeResults</span><span class="p">(</span><span class="n">code_data</span><span class="o">=</span><span class="n">code_data</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="n">buffer</span><span class="p">)</span>
    
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">code_results</span><span class="o">.</span><span class="n">landuseValueForOneCondition</span><span class="p">(</span><span class="n">land_use</span><span class="o">=</span><span class="n">land_use</span><span class="p">)</span>
    <span class="n">ci</span><span class="p">,</span> <span class="n">pi</span> <span class="o">=</span> <span class="n">code_results</span><span class="o">.</span><span class="n">rhoForALAndUseCategory</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">px</span> <span class="o">=</span> <span class="n">code_results</span><span class="o">.</span><span class="n">exactPValueForRho</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span> <span class="n">code</span><span class="p">,</span> <span class="s2">&quot;landuse&quot;</span><span class="p">:</span> <span class="n">land_use</span><span class="p">,</span> <span class="s2">&quot;a_symp&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">pi</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">ci</span><span class="p">),</span> <span class="s2">&quot;exact&quot;</span><span class="p">:</span> <span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">px</span><span class="o">.</span><span class="n">pvalue</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="n">px</span><span class="o">.</span><span class="n">statistic</span><span class="p">,)}</span>

<span class="nd">@timer</span>
<span class="k">def</span> <span class="nf">rhoForOneBuffer</span><span class="p">(</span><span class="n">data</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">buffer_file</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;resources/buffer_output/luse_1500.csv&quot;</span><span class="p">,</span> 
                    <span class="n">codes</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">land_use</span><span class="p">:</span> <span class="nb">list</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span><span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">pdtype</span><span class="p">,</span> <span class="n">pdtype</span><span class="p">):</span>
    
    <span class="n">buffer_locations</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">new_buffer</span><span class="p">,</span> <span class="n">buffer_vals</span> <span class="o">=</span> <span class="n">makeBufferObject</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">buffer_file</span><span class="p">,</span> <span class="n">buffer_locations</span><span class="o">=</span><span class="n">buffer_locations</span><span class="p">)</span>    
        
    <span class="n">rhovals_for_this_buffer</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">codes</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">use</span> <span class="ow">in</span> <span class="n">land_use</span><span class="p">:</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">asymptoticAndExactPvalues</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">buffer</span><span class="o">=</span><span class="n">buffer_vals</span><span class="p">,</span> <span class="n">code</span><span class="o">=</span><span class="n">code</span><span class="p">,</span> <span class="n">land_use</span><span class="o">=</span><span class="n">use</span><span class="p">)</span>
            <span class="n">rhovals_for_this_buffer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">rhovals_for_this_buffer</span><span class="p">,</span> <span class="n">new_buffer</span><span class="p">,</span> <span class="n">buffer_vals</span>

<span class="k">def</span> <span class="nf">resultsDf</span><span class="p">(</span><span class="n">rhovals</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pvals</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span><span class="o">-&gt;</span> <span class="n">pdtype</span><span class="p">:</span>
    <span class="n">results_df</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">pvals</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="n">arow_of_ps</span> <span class="o">=</span> <span class="n">pvals</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">p_fail</span> <span class="o">=</span> <span class="n">arow_of_ps</span><span class="p">[</span> <span class="n">arow_of_ps</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">]</span>
        <span class="n">arow_of_rhos</span> <span class="o">=</span> <span class="n">rhovals</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">p_fail</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
            <span class="n">arow_of_rhos</span><span class="p">[</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">results_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">arow_of_rhos</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">results_df</span>

<span class="k">def</span> <span class="nf">rotateText</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="s1">&#39;writing-mode: vertical-lr; transform: rotate(-180deg);  padding:10px; margins:0; vertical-align: baseline;&#39;</span>

<span class="k">def</span> <span class="nf">nObjectsPerLandUse</span><span class="p">(</span><span class="n">uses</span><span class="p">,</span><span class="n">surveys</span><span class="p">):</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">a_use</span> <span class="ow">in</span> <span class="n">uses</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">surveys</span><span class="p">[</span><span class="n">surveys</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">uses</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">a_use</span><span class="p">])]</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
        <span class="n">results</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="n">a_use</span><span class="p">:</span><span class="n">total</span><span class="p">})</span>
    
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">results</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">data</span><span class="o">=</span><span class="n">results</span><span class="o">.</span><span class="n">values</span><span class="p">(),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</details>
</div>
<p>To get the correlation coefficients for the data of interest call <i>rhoForOneBuffer</i> with the desired data, locations, the list of codes and the landuse attributes of interest:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># collecting survey data</span>
<span class="n">fdx</span> <span class="o">=</span> <span class="n">SurveyResults</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fdx</span><span class="o">.</span><span class="n">surveyResults</span><span class="p">()</span>
<span class="c1"># the locations on Neuchatel</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">locations</span><span class="p">)]</span>

<span class="c1"># the land use features we are interested in</span>
<span class="n">land_use</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span>  <span class="s2">&quot;industrial&quot;</span><span class="p">,</span> <span class="s2">&quot;roads&quot;</span><span class="p">,</span> <span class="s2">&quot;recreation&quot;</span><span class="p">,</span> <span class="s2">&quot;agriculture&quot;</span><span class="p">,</span><span class="s2">&quot;woods&quot;</span><span class="p">,</span> <span class="s2">&quot;intersects&quot;</span><span class="p">,</span> <span class="s2">&quot;unproductive&quot;</span><span class="p">]</span>

<span class="c1"># codes of interest</span>
<span class="c1"># we are interested in objects that were found in 1/2 surveys</span>
<span class="n">fail</span> <span class="o">=</span> <span class="mf">.5</span>

<span class="c1"># calculate the frequency that each code was found</span>
<span class="n">codes_fail</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">loc_date</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="c1"># Only codes that were found in  at least .5 of all samples</span>
<span class="n">codes_fail</span> <span class="o">=</span> <span class="n">codes_fail</span><span class="p">[</span><span class="n">codes_fail</span> <span class="o">&gt;</span> <span class="n">fail</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># identify the land_use data</span>
<span class="n">buffer_file</span> <span class="o">=</span> <span class="s2">&quot;resources/buffer_output/luse_1500.csv&quot;</span>

<span class="c1"># make the buffer and get the coeficients</span>
<span class="n">rho_vals</span><span class="p">,</span> <span class="n">new_buffer</span><span class="p">,</span> <span class="n">buffer_vals</span> <span class="o">=</span> <span class="n">rhoForOneBuffer</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">buffer_file</span><span class="o">=</span><span class="n">buffer_file</span> <span class="p">,</span> <span class="n">codes</span><span class="o">=</span><span class="n">codes_fail</span><span class="p">,</span> <span class="n">land_use</span><span class="o">=</span><span class="n">land_use</span><span class="p">)</span>
</pre></div>
</div>
<p>The method returns an array of results (rho_vals), the buffer object (new_buffer) and the buffer values from the buffer object (buffer_vals) in %of total land use (example one). The aysmptotic and exact p value is calculated by default for each code and landuse attribute. The results stored in the rho_vals array can be turned into a dataframe. That dataframe contains the correlation coeficients and the p-values for all the requested code values and land attributes. Finally to display the value of the coeficients for those objects that have a p-value &lt; 0.05 call resultsDF and provide as arugments one dataframe of the coeficients and one of the p-values.</p>
<p><em>Example: displaying the objects and the correlation coeficients at each landuse attribute where p &lt; 0.05. Note : 0.00 = p &gt; 0.05 for that code and land attribute</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># extracting the results of the correlation test from rho_vals</span>
<span class="c1"># this produces an array of dictionaries</span>
<span class="n">buffer_results</span> <span class="o">=</span> <span class="p">[{</span><span class="s2">&quot;code&quot;</span><span class="p">:</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;code&quot;</span><span class="p">],</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;landuse&quot;</span><span class="p">],</span> <span class="s2">&quot;exact_p&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;exact&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;p&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;a_symp&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;rho&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;exact&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">]}</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">rho_vals</span><span class="p">]</span>

<span class="c1"># pass buffer values to the dataframe constructor</span>
<span class="n">rho_at_buffer</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">buffer_results</span><span class="p">)</span>

<span class="c1"># from the data frame create one each: data frame of p-values and rho-values</span>
<span class="c1"># slicing the p-values from the results dataframe</span>
<span class="c1"># Select &quot;p&quot; or &quot;exact_p&quot; depending on the number of samples</span>
<span class="n">pvals</span> <span class="o">=</span> <span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;use&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;exact_p&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span>
<span class="n">rhovals</span> <span class="o">=</span> <span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;use&quot;</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s2">&quot;rho&quot;</span><span class="p">,</span> <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;first&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># use the two dataframes as arguments to resultsDf and call the dataframe constructor on the return val</span>
<span class="n">buffer_results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultsDf</span><span class="p">(</span><span class="n">rhovals</span><span class="p">,</span> <span class="n">pvals</span><span class="p">))</span>

<span class="c1"># format for display</span>
<span class="n">buffer_results</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">bfr</span> <span class="o">=</span> <span class="n">buffer_results</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span><span class="n">table_css_styles</span><span class="p">)</span>
<span class="n">bfr</span> <span class="o">=</span> <span class="n">bfr</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">buffer_results</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">buffer_results</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">)</span>
<span class="n">bfr</span> <span class="o">=</span> <span class="n">bfr</span><span class="o">.</span><span class="n">applymap_index</span><span class="p">(</span><span class="n">rotateText</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># collecting survey data</span>
<span class="n">fdx</span> <span class="o">=</span> <span class="n">SurveyResults</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">fdx</span><span class="o">.</span><span class="n">surveyResults</span><span class="p">()</span>
<span class="c1"># the locations on Neuchatel</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">locations</span><span class="p">)]</span>

<span class="c1"># the land use features we are interested in</span>
<span class="n">land_use</span> <span class="o">=</span><span class="p">[</span><span class="s2">&quot;buildings&quot;</span><span class="p">,</span>  <span class="s2">&quot;industrial&quot;</span><span class="p">,</span> <span class="s2">&quot;roads&quot;</span><span class="p">,</span> <span class="s2">&quot;recreation&quot;</span><span class="p">,</span> <span class="s2">&quot;agriculture&quot;</span><span class="p">,</span><span class="s2">&quot;woods&quot;</span><span class="p">,</span> <span class="s2">&quot;intersects&quot;</span><span class="p">,</span> <span class="s2">&quot;unproductive&quot;</span><span class="p">]</span>

<span class="c1"># codes of interest</span>
<span class="c1"># we are interested in objects that were found in 1/2 surveys</span>
<span class="n">fail</span> <span class="o">=</span> <span class="mf">.5</span>

<span class="c1"># calculate the frequency that each code was found</span>
<span class="n">codes_fail</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">quantity</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">/</span><span class="n">df</span><span class="o">.</span><span class="n">loc_date</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="c1"># Only codes that were found in  at least .5 of all samples</span>
<span class="n">codes_fail</span> <span class="o">=</span> <span class="n">codes_fail</span><span class="p">[</span><span class="n">codes_fail</span> <span class="o">&gt;</span> <span class="n">fail</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>

<span class="c1"># identify the land_use data</span>
<span class="n">buffer_file</span> <span class="o">=</span> <span class="s2">&quot;resources/buffer_output/luse_1500.csv&quot;</span>

<span class="c1"># make the buffer and get the coeficients</span>
<span class="n">rho_vals</span><span class="p">,</span> <span class="n">new_buffer</span><span class="p">,</span> <span class="n">buffer_vals</span> <span class="o">=</span> <span class="n">rhoForOneBuffer</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">buffer_file</span><span class="o">=</span><span class="n">buffer_file</span> <span class="p">,</span> <span class="n">codes</span><span class="o">=</span><span class="n">codes_fail</span><span class="p">,</span> <span class="n">land_use</span><span class="o">=</span><span class="n">land_use</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Finished &#39;rhoForOneBuffer&#39; in 34.809 secs
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input tag_remove-input docutils container">
</div>
<div class="figure align-default" id="bielersee-rho-results">
<div class="output text_html"><style type="text/css">
#T_28595 tr:nth-child(even) {
  background-color: rgba(139, 69, 19, 0.08);
}
#T_28595 tr:nth-child(odd) {
  background: #FFF;
}
#T_28595 tr {
  font-size: 12px;
}
#T_28595 th:nth-child(1) {
  background-color: #FFF;
}
#T_28595_row0_col0 {
  background-color: #5a78e4;
  color: #f1f1f1;
}
#T_28595_row0_col1 {
  background-color: #d24b40;
  color: #f1f1f1;
}
#T_28595_row0_col2 {
  background-color: #e57058;
  color: #f1f1f1;
}
#T_28595_row0_col3 {
  background-color: #3b4cc0;
  color: #f1f1f1;
}
#T_28595_row0_col4 {
  background-color: #d65244;
  color: #f1f1f1;
}
#T_28595_row0_col5 {
  background-color: #cf453c;
  color: #f1f1f1;
}
#T_28595_row0_col6 {
  background-color: #6b8df0;
  color: #f1f1f1;
}
#T_28595_row0_col7, #T_28595_row1_col0, #T_28595_row1_col1, #T_28595_row1_col2, #T_28595_row1_col3, #T_28595_row1_col4, #T_28595_row1_col5, #T_28595_row1_col6, #T_28595_row1_col7, #T_28595_row2_col0, #T_28595_row2_col2, #T_28595_row2_col3, #T_28595_row2_col4, #T_28595_row2_col6, #T_28595_row2_col7, #T_28595_row4_col0, #T_28595_row4_col6, #T_28595_row4_col7, #T_28595_row5_col0, #T_28595_row5_col1, #T_28595_row5_col2, #T_28595_row5_col3, #T_28595_row5_col4, #T_28595_row5_col5, #T_28595_row5_col6, #T_28595_row5_col7, #T_28595_row6_col0, #T_28595_row6_col2, #T_28595_row6_col3, #T_28595_row6_col4, #T_28595_row6_col5, #T_28595_row6_col6, #T_28595_row6_col7, #T_28595_row7_col1, #T_28595_row7_col2, #T_28595_row7_col3, #T_28595_row7_col4, #T_28595_row7_col5, #T_28595_row8_col0, #T_28595_row8_col1, #T_28595_row8_col2, #T_28595_row8_col3, #T_28595_row8_col4, #T_28595_row8_col5, #T_28595_row8_col6, #T_28595_row8_col7, #T_28595_row9_col7, #T_28595_row10_col1, #T_28595_row10_col2, #T_28595_row10_col3, #T_28595_row10_col4, #T_28595_row10_col5 {
  background-color: #dadce0;
  color: #000000;
}
#T_28595_row2_col1 {
  background-color: #f4987a;
  color: #000000;
}
#T_28595_row2_col5 {
  background-color: #f29274;
  color: #f1f1f1;
}
#T_28595_row3_col0 {
  background-color: #4961d2;
  color: #f1f1f1;
}
#T_28595_row3_col1 {
  background-color: #ea7b60;
  color: #f1f1f1;
}
#T_28595_row3_col2 {
  background-color: #eb7d62;
  color: #f1f1f1;
}
#T_28595_row3_col3 {
  background-color: #4e68d8;
  color: #f1f1f1;
}
#T_28595_row3_col4 {
  background-color: #e36b54;
  color: #f1f1f1;
}
#T_28595_row3_col5 {
  background-color: #ec8165;
  color: #f1f1f1;
}
#T_28595_row3_col6, #T_28595_row9_col0 {
  background-color: #5d7ce6;
  color: #f1f1f1;
}
#T_28595_row3_col7 {
  background-color: #ee8468;
  color: #f1f1f1;
}
#T_28595_row4_col1 {
  background-color: #e26952;
  color: #f1f1f1;
}
#T_28595_row4_col2 {
  background-color: #f39475;
  color: #000000;
}
#T_28595_row4_col3, #T_28595_row7_col7 {
  background-color: #4b64d5;
  color: #f1f1f1;
}
#T_28595_row4_col4 {
  background-color: #f08a6c;
  color: #f1f1f1;
}
#T_28595_row4_col5 {
  background-color: #e7745b;
  color: #f1f1f1;
}
#T_28595_row6_col1, #T_28595_row10_col0 {
  background-color: #f39778;
  color: #000000;
}
#T_28595_row7_col0 {
  background-color: #df634e;
  color: #f1f1f1;
}
#T_28595_row7_col6 {
  background-color: #e36c55;
  color: #f1f1f1;
}
#T_28595_row9_col1 {
  background-color: #b40426;
  color: #f1f1f1;
}
#T_28595_row9_col2 {
  background-color: #cc403a;
  color: #f1f1f1;
}
#T_28595_row9_col3 {
  background-color: #4055c8;
  color: #f1f1f1;
}
#T_28595_row9_col4 {
  background-color: #c73635;
  color: #f1f1f1;
}
#T_28595_row9_col5 {
  background-color: #bd1f2d;
  color: #f1f1f1;
}
#T_28595_row9_col6 {
  background-color: #5f7fe8;
  color: #f1f1f1;
}
#T_28595_row10_col6 {
  background-color: #ee8669;
  color: #f1f1f1;
}
#T_28595_row10_col7 {
  background-color: #6384eb;
  color: #f1f1f1;
}
#T_28595_level0_col0, #T_28595_level0_col1, #T_28595_level0_col2, #T_28595_level0_col3, #T_28595_level0_col4, #T_28595_level0_col5, #T_28595_level0_col6, #T_28595_level0_col7 {
  writing-mode: vertical-lr;
  transform: rotate(-180deg);
  padding: 10px;
  margins: 0;
  vertical-align: baseline;
}
</style>
<table id="T_28595">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_28595_level0_col0" class="col_heading level0 col0" >agriculture</th>
      <th id="T_28595_level0_col1" class="col_heading level0 col1" >buildings</th>
      <th id="T_28595_level0_col2" class="col_heading level0 col2" >industrial</th>
      <th id="T_28595_level0_col3" class="col_heading level0 col3" >intersects</th>
      <th id="T_28595_level0_col4" class="col_heading level0 col4" >recreation</th>
      <th id="T_28595_level0_col5" class="col_heading level0 col5" >roads</th>
      <th id="T_28595_level0_col6" class="col_heading level0 col6" >unproductive</th>
      <th id="T_28595_level0_col7" class="col_heading level0 col7" >woods</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_28595_level0_row0" class="row_heading level0 row0" >G177</th>
      <td id="T_28595_row0_col0" class="data row0 col0" >-0.49</td>
      <td id="T_28595_row0_col1" class="data row0 col1" >0.53</td>
      <td id="T_28595_row0_col2" class="data row0 col2" >0.44</td>
      <td id="T_28595_row0_col3" class="data row0 col3" >-0.62</td>
      <td id="T_28595_row0_col4" class="data row0 col4" >0.52</td>
      <td id="T_28595_row0_col5" class="data row0 col5" >0.54</td>
      <td id="T_28595_row0_col6" class="data row0 col6" >-0.42</td>
      <td id="T_28595_row0_col7" class="data row0 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_28595_level0_row1" class="row_heading level0 row1" >G200</th>
      <td id="T_28595_row1_col0" class="data row1 col0" >0.00</td>
      <td id="T_28595_row1_col1" class="data row1 col1" >0.00</td>
      <td id="T_28595_row1_col2" class="data row1 col2" >0.00</td>
      <td id="T_28595_row1_col3" class="data row1 col3" >0.00</td>
      <td id="T_28595_row1_col4" class="data row1 col4" >0.00</td>
      <td id="T_28595_row1_col5" class="data row1 col5" >0.00</td>
      <td id="T_28595_row1_col6" class="data row1 col6" >0.00</td>
      <td id="T_28595_row1_col7" class="data row1 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_28595_level0_row2" class="row_heading level0 row2" >G25</th>
      <td id="T_28595_row2_col0" class="data row2 col0" >0.00</td>
      <td id="T_28595_row2_col1" class="data row2 col1" >0.33</td>
      <td id="T_28595_row2_col2" class="data row2 col2" >0.00</td>
      <td id="T_28595_row2_col3" class="data row2 col3" >0.00</td>
      <td id="T_28595_row2_col4" class="data row2 col4" >0.00</td>
      <td id="T_28595_row2_col5" class="data row2 col5" >0.35</td>
      <td id="T_28595_row2_col6" class="data row2 col6" >0.00</td>
      <td id="T_28595_row2_col7" class="data row2 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_28595_level0_row3" class="row_heading level0 row3" >G27</th>
      <td id="T_28595_row3_col0" class="data row3 col0" >-0.56</td>
      <td id="T_28595_row3_col1" class="data row3 col1" >0.41</td>
      <td id="T_28595_row3_col2" class="data row3 col2" >0.41</td>
      <td id="T_28595_row3_col3" class="data row3 col3" >-0.54</td>
      <td id="T_28595_row3_col4" class="data row3 col4" >0.46</td>
      <td id="T_28595_row3_col5" class="data row3 col5" >0.40</td>
      <td id="T_28595_row3_col6" class="data row3 col6" >-0.48</td>
      <td id="T_28595_row3_col7" class="data row3 col7" >0.39</td>
    </tr>
    <tr>
      <th id="T_28595_level0_row4" class="row_heading level0 row4" >G30</th>
      <td id="T_28595_row4_col0" class="data row4 col0" >0.00</td>
      <td id="T_28595_row4_col1" class="data row4 col1" >0.46</td>
      <td id="T_28595_row4_col2" class="data row4 col2" >0.34</td>
      <td id="T_28595_row4_col3" class="data row4 col3" >-0.55</td>
      <td id="T_28595_row4_col4" class="data row4 col4" >0.37</td>
      <td id="T_28595_row4_col5" class="data row4 col5" >0.43</td>
      <td id="T_28595_row4_col6" class="data row4 col6" >0.00</td>
      <td id="T_28595_row4_col7" class="data row4 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_28595_level0_row5" class="row_heading level0 row5" >G67</th>
      <td id="T_28595_row5_col0" class="data row5 col0" >0.00</td>
      <td id="T_28595_row5_col1" class="data row5 col1" >0.00</td>
      <td id="T_28595_row5_col2" class="data row5 col2" >0.00</td>
      <td id="T_28595_row5_col3" class="data row5 col3" >0.00</td>
      <td id="T_28595_row5_col4" class="data row5 col4" >0.00</td>
      <td id="T_28595_row5_col5" class="data row5 col5" >0.00</td>
      <td id="T_28595_row5_col6" class="data row5 col6" >0.00</td>
      <td id="T_28595_row5_col7" class="data row5 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_28595_level0_row6" class="row_heading level0 row6" >G89</th>
      <td id="T_28595_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_28595_row6_col1" class="data row6 col1" >0.33</td>
      <td id="T_28595_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_28595_row6_col3" class="data row6 col3" >0.00</td>
      <td id="T_28595_row6_col4" class="data row6 col4" >0.00</td>
      <td id="T_28595_row6_col5" class="data row6 col5" >0.00</td>
      <td id="T_28595_row6_col6" class="data row6 col6" >0.00</td>
      <td id="T_28595_row6_col7" class="data row6 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_28595_level0_row7" class="row_heading level0 row7" >G904</th>
      <td id="T_28595_row7_col0" class="data row7 col0" >0.48</td>
      <td id="T_28595_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_28595_row7_col2" class="data row7 col2" >0.00</td>
      <td id="T_28595_row7_col3" class="data row7 col3" >0.00</td>
      <td id="T_28595_row7_col4" class="data row7 col4" >0.00</td>
      <td id="T_28595_row7_col5" class="data row7 col5" >0.00</td>
      <td id="T_28595_row7_col6" class="data row7 col6" >0.45</td>
      <td id="T_28595_row7_col7" class="data row7 col7" >-0.54</td>
    </tr>
    <tr>
      <th id="T_28595_level0_row8" class="row_heading level0 row8" >G941</th>
      <td id="T_28595_row8_col0" class="data row8 col0" >0.00</td>
      <td id="T_28595_row8_col1" class="data row8 col1" >0.00</td>
      <td id="T_28595_row8_col2" class="data row8 col2" >0.00</td>
      <td id="T_28595_row8_col3" class="data row8 col3" >0.00</td>
      <td id="T_28595_row8_col4" class="data row8 col4" >0.00</td>
      <td id="T_28595_row8_col5" class="data row8 col5" >0.00</td>
      <td id="T_28595_row8_col6" class="data row8 col6" >0.00</td>
      <td id="T_28595_row8_col7" class="data row8 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_28595_level0_row9" class="row_heading level0 row9" >Gfoam</th>
      <td id="T_28595_row9_col0" class="data row9 col0" >-0.48</td>
      <td id="T_28595_row9_col1" class="data row9 col1" >0.64</td>
      <td id="T_28595_row9_col2" class="data row9 col2" >0.55</td>
      <td id="T_28595_row9_col3" class="data row9 col3" >-0.59</td>
      <td id="T_28595_row9_col4" class="data row9 col4" >0.57</td>
      <td id="T_28595_row9_col5" class="data row9 col5" >0.61</td>
      <td id="T_28595_row9_col6" class="data row9 col6" >-0.46</td>
      <td id="T_28595_row9_col7" class="data row9 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_28595_level0_row10" class="row_heading level0 row10" >Gfrags</th>
      <td id="T_28595_row10_col0" class="data row10 col0" >0.33</td>
      <td id="T_28595_row10_col1" class="data row10 col1" >0.00</td>
      <td id="T_28595_row10_col2" class="data row10 col2" >0.00</td>
      <td id="T_28595_row10_col3" class="data row10 col3" >0.00</td>
      <td id="T_28595_row10_col4" class="data row10 col4" >0.00</td>
      <td id="T_28595_row10_col5" class="data row10 col5" >0.00</td>
      <td id="T_28595_row10_col6" class="data row10 col6" >0.38</td>
      <td id="T_28595_row10_col7" class="data row10 col7" >-0.45</td>
    </tr>
  </tbody>
</table>
</div><p class="caption"><span class="caption-number">Fig. 1.3 </span><span class="caption-text"><code class="docutils literal notranslate"> </code></span><a class="headerlink" href="#bielersee-rho-results" title="Permalink to this image">#</a></p>
</div>
<p><a class="reference internal" href="#bielersee-rho-results"><span class="std std-numref">figure 1.3:</span></a> The corelation coeficient of trash density to landuse features for Bielersee. Coeffecients of 0 indicate that there is no statistical indication that the land use feature has an effect (positive or negative) on the trash density.</p>
</div>
</div>
<div class="section" id="covariance-of-explanatory-variables">
<h2><span class="section-number">1.4. </span>Covariance of explanatory variables<a class="headerlink" href="#covariance-of-explanatory-variables" title="Permalink to this headline">#</a></h2>
<p>The landuse attributes, considered here as independent variables, are also co-related. For example, the length of the road network in relation to the surface are attributed to buildings. For this analyis we should see similar results for co-related attributes (positive or negative). Most importantly, the assumed co-relation should make sense. Or, this may be casue for further investigation, indicating that the relationship is probably not well understood.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">buffer_percents</span> <span class="o">=</span> <span class="n">buffer_vals</span><span class="o">.</span><span class="n">T</span>
<span class="n">buffer_percents</span> <span class="o">=</span> <span class="n">buffer_percents</span><span class="p">[</span><span class="n">land_use</span><span class="p">]</span>
<span class="n">rho</span> <span class="o">=</span> <span class="n">buffer_percents</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;spearman&#39;</span><span class="p">)</span>
<span class="n">pval</span> <span class="o">=</span> <span class="n">buffer_percents</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">stats</span><span class="o">.</span><span class="n">spearmanr</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">pless</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultsDf</span><span class="p">(</span><span class="n">rho</span><span class="p">,</span> <span class="n">pval</span><span class="p">))</span>

<span class="n">pless</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">bfr</span> <span class="o">=</span> <span class="n">pless</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">set_table_styles</span><span class="p">(</span><span class="n">table_css_styles</span><span class="p">)</span>
<span class="n">bfr</span> <span class="o">=</span> <span class="n">bfr</span><span class="o">.</span><span class="n">background_gradient</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">rho</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">vmax</span><span class="o">=</span><span class="n">rho</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">)</span>
<span class="n">bfr</span> <span class="o">=</span> <span class="n">bfr</span><span class="o">.</span><span class="n">applymap_index</span><span class="p">(</span><span class="n">rotateText</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bfr</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><style type="text/css">
#T_487df tr:nth-child(even) {
  background-color: rgba(139, 69, 19, 0.08);
}
#T_487df tr:nth-child(odd) {
  background: #FFF;
}
#T_487df tr {
  font-size: 12px;
}
#T_487df th:nth-child(1) {
  background-color: #FFF;
}
#T_487df_row0_col0, #T_487df_row0_col4, #T_487df_row0_col5, #T_487df_row0_col6, #T_487df_row0_col7, #T_487df_row1_col1, #T_487df_row1_col4, #T_487df_row1_col5, #T_487df_row1_col6, #T_487df_row1_col7, #T_487df_row2_col2, #T_487df_row2_col4, #T_487df_row2_col5, #T_487df_row2_col6, #T_487df_row3_col3, #T_487df_row3_col4, #T_487df_row3_col5, #T_487df_row3_col6, #T_487df_row3_col7, #T_487df_row4_col0, #T_487df_row4_col1, #T_487df_row4_col2, #T_487df_row4_col3, #T_487df_row4_col4, #T_487df_row4_col5, #T_487df_row4_col7, #T_487df_row5_col0, #T_487df_row5_col1, #T_487df_row5_col2, #T_487df_row5_col3, #T_487df_row5_col4, #T_487df_row5_col5, #T_487df_row5_col6, #T_487df_row5_col7, #T_487df_row6_col0, #T_487df_row6_col1, #T_487df_row6_col2, #T_487df_row6_col3, #T_487df_row6_col5, #T_487df_row6_col6, #T_487df_row6_col7, #T_487df_row7_col0, #T_487df_row7_col1, #T_487df_row7_col3, #T_487df_row7_col4, #T_487df_row7_col5, #T_487df_row7_col6, #T_487df_row7_col7 {
  background-color: #c6d6f1;
  color: #000000;
}
#T_487df_row0_col1, #T_487df_row1_col0 {
  background-color: #b50927;
  color: #f1f1f1;
}
#T_487df_row0_col2, #T_487df_row2_col0 {
  background-color: #c0282f;
  color: #f1f1f1;
}
#T_487df_row0_col3, #T_487df_row3_col0 {
  background-color: #be242e;
  color: #f1f1f1;
}
#T_487df_row1_col2, #T_487df_row2_col1 {
  background-color: #c83836;
  color: #f1f1f1;
}
#T_487df_row1_col3, #T_487df_row3_col1 {
  background-color: #b40426;
  color: #f1f1f1;
}
#T_487df_row2_col3, #T_487df_row3_col2 {
  background-color: #d65244;
  color: #f1f1f1;
}
#T_487df_row2_col7, #T_487df_row7_col2 {
  background-color: #3b4cc0;
  color: #f1f1f1;
}
#T_487df_row4_col6, #T_487df_row6_col4 {
  background-color: #e46e56;
  color: #f1f1f1;
}
#T_487df_level0_col0, #T_487df_level0_col1, #T_487df_level0_col2, #T_487df_level0_col3, #T_487df_level0_col4, #T_487df_level0_col5, #T_487df_level0_col6, #T_487df_level0_col7 {
  writing-mode: vertical-lr;
  transform: rotate(-180deg);
  padding: 10px;
  margins: 0;
  vertical-align: baseline;
}
</style>
<table id="T_487df">
  <thead>
    <tr>
      <th class="blank level0" >&nbsp;</th>
      <th id="T_487df_level0_col0" class="col_heading level0 col0" >buildings</th>
      <th id="T_487df_level0_col1" class="col_heading level0 col1" >industrial</th>
      <th id="T_487df_level0_col2" class="col_heading level0 col2" >roads</th>
      <th id="T_487df_level0_col3" class="col_heading level0 col3" >recreation</th>
      <th id="T_487df_level0_col4" class="col_heading level0 col4" >agriculture</th>
      <th id="T_487df_level0_col5" class="col_heading level0 col5" >woods</th>
      <th id="T_487df_level0_col6" class="col_heading level0 col6" >intersects</th>
      <th id="T_487df_level0_col7" class="col_heading level0 col7" >unproductive</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th id="T_487df_level0_row0" class="row_heading level0 row0" >buildings</th>
      <td id="T_487df_row0_col0" class="data row0 col0" >0.00</td>
      <td id="T_487df_row0_col1" class="data row0 col1" >0.90</td>
      <td id="T_487df_row0_col2" class="data row0 col2" >0.86</td>
      <td id="T_487df_row0_col3" class="data row0 col3" >0.87</td>
      <td id="T_487df_row0_col4" class="data row0 col4" >0.00</td>
      <td id="T_487df_row0_col5" class="data row0 col5" >0.00</td>
      <td id="T_487df_row0_col6" class="data row0 col6" >0.00</td>
      <td id="T_487df_row0_col7" class="data row0 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_487df_level0_row1" class="row_heading level0 row1" >industrial</th>
      <td id="T_487df_row1_col0" class="data row1 col0" >0.90</td>
      <td id="T_487df_row1_col1" class="data row1 col1" >0.00</td>
      <td id="T_487df_row1_col2" class="data row1 col2" >0.82</td>
      <td id="T_487df_row1_col3" class="data row1 col3" >0.91</td>
      <td id="T_487df_row1_col4" class="data row1 col4" >0.00</td>
      <td id="T_487df_row1_col5" class="data row1 col5" >0.00</td>
      <td id="T_487df_row1_col6" class="data row1 col6" >0.00</td>
      <td id="T_487df_row1_col7" class="data row1 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_487df_level0_row2" class="row_heading level0 row2" >roads</th>
      <td id="T_487df_row2_col0" class="data row2 col0" >0.86</td>
      <td id="T_487df_row2_col1" class="data row2 col1" >0.82</td>
      <td id="T_487df_row2_col2" class="data row2 col2" >0.00</td>
      <td id="T_487df_row2_col3" class="data row2 col3" >0.76</td>
      <td id="T_487df_row2_col4" class="data row2 col4" >0.00</td>
      <td id="T_487df_row2_col5" class="data row2 col5" >0.00</td>
      <td id="T_487df_row2_col6" class="data row2 col6" >0.00</td>
      <td id="T_487df_row2_col7" class="data row2 col7" >-0.66</td>
    </tr>
    <tr>
      <th id="T_487df_level0_row3" class="row_heading level0 row3" >recreation</th>
      <td id="T_487df_row3_col0" class="data row3 col0" >0.87</td>
      <td id="T_487df_row3_col1" class="data row3 col1" >0.91</td>
      <td id="T_487df_row3_col2" class="data row3 col2" >0.76</td>
      <td id="T_487df_row3_col3" class="data row3 col3" >0.00</td>
      <td id="T_487df_row3_col4" class="data row3 col4" >0.00</td>
      <td id="T_487df_row3_col5" class="data row3 col5" >0.00</td>
      <td id="T_487df_row3_col6" class="data row3 col6" >0.00</td>
      <td id="T_487df_row3_col7" class="data row3 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_487df_level0_row4" class="row_heading level0 row4" >agriculture</th>
      <td id="T_487df_row4_col0" class="data row4 col0" >0.00</td>
      <td id="T_487df_row4_col1" class="data row4 col1" >0.00</td>
      <td id="T_487df_row4_col2" class="data row4 col2" >0.00</td>
      <td id="T_487df_row4_col3" class="data row4 col3" >0.00</td>
      <td id="T_487df_row4_col4" class="data row4 col4" >0.00</td>
      <td id="T_487df_row4_col5" class="data row4 col5" >0.00</td>
      <td id="T_487df_row4_col6" class="data row4 col6" >0.67</td>
      <td id="T_487df_row4_col7" class="data row4 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_487df_level0_row5" class="row_heading level0 row5" >woods</th>
      <td id="T_487df_row5_col0" class="data row5 col0" >0.00</td>
      <td id="T_487df_row5_col1" class="data row5 col1" >0.00</td>
      <td id="T_487df_row5_col2" class="data row5 col2" >0.00</td>
      <td id="T_487df_row5_col3" class="data row5 col3" >0.00</td>
      <td id="T_487df_row5_col4" class="data row5 col4" >0.00</td>
      <td id="T_487df_row5_col5" class="data row5 col5" >0.00</td>
      <td id="T_487df_row5_col6" class="data row5 col6" >0.00</td>
      <td id="T_487df_row5_col7" class="data row5 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_487df_level0_row6" class="row_heading level0 row6" >intersects</th>
      <td id="T_487df_row6_col0" class="data row6 col0" >0.00</td>
      <td id="T_487df_row6_col1" class="data row6 col1" >0.00</td>
      <td id="T_487df_row6_col2" class="data row6 col2" >0.00</td>
      <td id="T_487df_row6_col3" class="data row6 col3" >0.00</td>
      <td id="T_487df_row6_col4" class="data row6 col4" >0.67</td>
      <td id="T_487df_row6_col5" class="data row6 col5" >0.00</td>
      <td id="T_487df_row6_col6" class="data row6 col6" >0.00</td>
      <td id="T_487df_row6_col7" class="data row6 col7" >0.00</td>
    </tr>
    <tr>
      <th id="T_487df_level0_row7" class="row_heading level0 row7" >unproductive</th>
      <td id="T_487df_row7_col0" class="data row7 col0" >0.00</td>
      <td id="T_487df_row7_col1" class="data row7 col1" >0.00</td>
      <td id="T_487df_row7_col2" class="data row7 col2" >-0.66</td>
      <td id="T_487df_row7_col3" class="data row7 col3" >0.00</td>
      <td id="T_487df_row7_col4" class="data row7 col4" >0.00</td>
      <td id="T_487df_row7_col5" class="data row7 col5" >0.00</td>
      <td id="T_487df_row7_col6" class="data row7 col6" >0.00</td>
      <td id="T_487df_row7_col7" class="data row7 col7" >0.00</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
</div>
<div class="section" id="total-correlations-total-positive-correlations-and-total-negative-corrrelations">
<h2><span class="section-number">1.5. </span>Total correlations, total positive correlations and total negative corrrelations<a class="headerlink" href="#total-correlations-total-positive-correlations-and-total-negative-corrrelations" title="Permalink to this headline">#</a></h2>
<p>The total correlations for a landuse attribute, (when considered with the attribute corelation table above) is an indication of the variety of objects that may be encountered at a suvey.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">countTheNumberOfCorrelationsPerBuffer</span><span class="p">(</span><span class="n">pvals</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rhovals</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">(</span><span class="n">pdtype</span><span class="p">,</span> <span class="n">pstype</span><span class="p">):</span>
    
    <span class="c1"># the number of times p &lt;= 0.05</span>
    <span class="n">number_p_less_than</span> <span class="o">=</span> <span class="p">(</span><span class="n">pvals</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">number_p_less_than</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;correlated&quot;</span>
    
    <span class="c1"># the number of postive correlations</span>
    <span class="n">number_pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">rhovals</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">number_pos</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;positive&quot;</span>
    
    <span class="c1"># the number of negative correlations</span>
    <span class="n">number_neg</span> <span class="o">=</span> <span class="p">(</span><span class="n">rhovals</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">number_neg</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;negative&quot;</span>

    <span class="n">ncorrelated</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">number_p_less_than</span><span class="p">,</span> <span class="n">number_pos</span><span class="p">,</span> <span class="n">number_neg</span><span class="p">])</span>
    <span class="n">ncorrelated</span><span class="p">[</span><span class="s2">&quot;total&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ncorrelated</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">ncorrelated</span><span class="p">,</span> <span class="n">ncorrelated</span><span class="o">.</span><span class="n">total</span>

<span class="n">ncorrelated</span><span class="p">,</span> <span class="n">total</span> <span class="o">=</span> <span class="n">countTheNumberOfCorrelationsPerBuffer</span><span class="p">(</span><span class="n">pvals</span><span class="p">,</span> <span class="n">rhovals</span><span class="p">)</span>
<span class="n">ncorrelated</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>agriculture</th>
      <th>buildings</th>
      <th>industrial</th>
      <th>intersects</th>
      <th>recreation</th>
      <th>roads</th>
      <th>unproductive</th>
      <th>woods</th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>correlated</th>
      <td>5</td>
      <td>6</td>
      <td>4</td>
      <td>4</td>
      <td>4</td>
      <td>5</td>
      <td>5</td>
      <td>3</td>
      <td>36</td>
    </tr>
    <tr>
      <th>positive</th>
      <td>2</td>
      <td>6</td>
      <td>4</td>
      <td>0</td>
      <td>4</td>
      <td>5</td>
      <td>2</td>
      <td>1</td>
      <td>24</td>
    </tr>
    <tr>
      <th>negative</th>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>4</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>2</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="section" id="sum-of-the-total-number-of-objects-with-a-correlation-positive-or-negative-collected-under-the-different-land-use-categories">
<h3><span class="section-number">1.5.1. </span>Sum of the total number of objects with a correlation (positive or negative) collected under the different land use categories<a class="headerlink" href="#sum-of-the-total-number-of-objects-with-a-correlation-positive-or-negative-collected-under-the-different-land-use-categories" title="Permalink to this headline">#</a></h3>
<p>The number of objects correlated is an indication of how much of the trash could be accounted for given the thresholds used for abundance or fail rate.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">numberOfObjectsCorrelatedPerAttribute</span><span class="p">(</span><span class="n">rho_at_buffer</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">df</span><span class="p">:</span> <span class="n">pdtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pdtype</span><span class="p">:</span>
    
    <span class="c1"># select all the codes that have a p-value less than 0.05</span>
    <span class="n">p_less_than</span> <span class="o">=</span> <span class="n">rho_at_buffer</span><span class="p">[</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">exact_p</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">]</span>

    <span class="c1"># group the codes by land use attribute</span>
    <span class="n">p_less_than_use_codes</span> <span class="o">=</span> <span class="n">p_less_than</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;use&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>

    <span class="c1"># sume the number of objects with a correlation (positive or negative) for each land use attribute</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">nObjectsPerLandUse</span><span class="p">(</span><span class="n">p_less_than_use_codes</span><span class="p">,</span><span class="n">df</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">results</span>

<span class="n">numberOfObjectsCorrelatedPerAttribute</span><span class="p">(</span><span class="n">rho_at_buffer</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>agriculture</th>
      <td>1800</td>
    </tr>
    <tr>
      <th>buildings</th>
      <td>1484</td>
    </tr>
    <tr>
      <th>industrial</th>
      <td>1303</td>
    </tr>
    <tr>
      <th>intersects</th>
      <td>1303</td>
    </tr>
    <tr>
      <th>recreation</th>
      <td>1303</td>
    </tr>
    <tr>
      <th>roads</th>
      <td>1395</td>
    </tr>
    <tr>
      <th>unproductive</th>
      <td>1800</td>
    </tr>
    <tr>
      <th>woods</th>
      <td>1566</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
</div>
<div class="section" id="the-objects-of-interest">
<h2><span class="section-number">1.6. </span>The objects of interest<a class="headerlink" href="#the-objects-of-interest" title="Permalink to this headline">#</a></h2>
<p>Setting a threshold value for the dependent variable implies that we will not be using all the records availble. The threshold value defining the objects of interest was a fail rate &gt;= 1/2. Which means that at least one out two samples will have a quantity &gt; 0.</p>
<div class="section" id="the-total-of-materials-of-the-objects-of-interest-with-respect-to-the-total-number-of-objects-collected">
<h3><span class="section-number">1.6.1. </span>The % total of materials of the objects of interest with respect to the total number of objects collected.<a class="headerlink" href="#the-total-of-materials-of-the-objects-of-interest-with-respect-to-the-total-number-of-objects-collected" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">thePercentTotalOfMaterials</span><span class="p">(</span><span class="n">codes</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">materialmap</span><span class="p">):</span>
    
    <span class="n">total</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">buffer_codes</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">codes</span><span class="p">)]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">buffer_codes</span><span class="p">[</span><span class="s2">&quot;material&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">buffer_codes</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">materialmap</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
    
    <span class="n">material_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">buffer_codes</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;material&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">total</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    
    <span class="n">material_df</span><span class="p">[</span><span class="s2">&quot;quantity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">material_df</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">((</span><span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">material_df</span>

<span class="n">thePercentTotalOfMaterials</span><span class="p">(</span><span class="n">codes_fail</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">code_m_map</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>quantity</th>
    </tr>
    <tr>
      <th>material</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Glass</th>
      <td>4%</td>
    </tr>
    <tr>
      <th>Metal</th>
      <td>1%</td>
    </tr>
    <tr>
      <th>Plastic</th>
      <td>63%</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="the-total-of-the-top-10-objects-with-respect-to-all-objects-collected">
<h3><span class="section-number">1.6.2. </span>The % total of the top 10 objects with respect to all objects collected.<a class="headerlink" href="#the-total-of-the-top-10-objects-with-respect-to-all-objects-collected" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">thePercentTotalOfTheTopXObjects</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">index</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s1">&#39;ratio of top </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1"> items over all items:&#39;</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;number of top </span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1"> items:&#39;</span><span class="p">]</span>
    <span class="n">item_totals</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">top_x</span> <span class="o">=</span> <span class="n">item_totals</span><span class="p">[:</span><span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">total</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">top_x</span><span class="w"> </span><span class="o">/</span><span class="n">total</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="p">))</span><span class="si">}</span><span class="s2">%&quot;</span><span class="p">,</span><span class="s2">&quot;</span><span class="si">{:,}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">top_x</span><span class="p">))]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">index</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;value&quot;</span><span class="p">])</span>

<span class="n">thePercentTotalOfTheTopXObjects</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ratio of top 10 items over all items:</th>
      <td>68%</td>
    </tr>
    <tr>
      <th>number of top 10 items:</th>
      <td>2,910</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="the-cumulative-totals-of-the-top-20-objects-grouped-by-economic-source">
<h3><span class="section-number">1.6.3. </span>The cumulative totals of the top 20 objects, grouped by economic source<a class="headerlink" href="#the-cumulative-totals-of-the-top-20-objects-grouped-by-economic-source" title="Permalink to this headline">#</a></h3>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">check_condition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    
    <span class="k">if</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">&amp;</span><span class="nb">set</span><span class="p">(</span><span class="n">conditions</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">conditions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>        
    <span class="k">elif</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">&amp;</span><span class="nb">set</span><span class="p">(</span><span class="n">conditions</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="s2">&quot;Others&quot;</span>    
    <span class="k">else</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">check_condition</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">conditions</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">data</span>

<span class="c1"># define the broad categories:</span>
<span class="n">tobaco</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Tobacco&quot;</span><span class="p">,</span> <span class="s2">&quot;Smoking related&quot;</span><span class="p">]</span>
<span class="n">industry</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Industry&#39;</span><span class="p">,</span><span class="s1">&#39;Construction&#39;</span><span class="p">,</span> <span class="s1">&#39;Industrial&#39;</span><span class="p">,</span> <span class="s1">&#39;Manufacturing&#39;</span><span class="p">]</span>
<span class="n">sanitary</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Sanitary&quot;</span><span class="p">,</span> <span class="s2">&quot;Personal hygiene&quot;</span><span class="p">,</span> <span class="s2">&quot;Water treatment&quot;</span><span class="p">]</span>
<span class="n">packaging</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Packaging (non-food)&#39;</span><span class="p">,</span><span class="s1">&#39;Packaging films nonfood or unknown&#39;</span><span class="p">,</span> <span class="s1">&#39;Paper packaging&#39;</span><span class="p">]</span>
<span class="n">food</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Food and drinks&#39;</span><span class="p">,</span><span class="s1">&#39;Foil wrappers, aluminum foil&#39;</span><span class="p">,</span> <span class="s1">&#39;Food and drinks&#39;</span><span class="p">,</span> <span class="s1">&#39;Food and drink&#39;</span><span class="p">]</span>
<span class="n">fragments</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Plastic fragments and pieces&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Plastic fragments angular &lt;5mm&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Styrofoam &lt; 5mm&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;Plastic fragments rounded &lt;5mm&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Foamed  plastic &lt;5mm&#39;</span><span class="p">,</span>
             <span class="s1">&#39;Fragmented plastics&#39;</span><span class="p">,</span>
            <span class="p">]</span>

<span class="n">conditions</span> <span class="o">=</span> <span class="p">[</span><span class="n">tobaco</span><span class="p">,</span> <span class="n">industry</span><span class="p">,</span> <span class="n">sanitary</span><span class="p">,</span> <span class="n">packaging</span><span class="p">,</span> <span class="n">food</span><span class="p">,</span> <span class="n">fragments</span><span class="p">]</span>


<span class="n">dT20</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="n">as_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s2">&quot;quantity&quot;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">dT20</span><span class="p">[</span><span class="s2">&quot;description&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dT20</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">code_d_map</span><span class="p">[</span><span class="n">x</span><span class="p">])</span>
<span class="n">dT20</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">dT20</span> <span class="o">=</span> <span class="n">dT20</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:</span><span class="mi">20</span><span class="p">,:]</span>
    
<span class="k">for</span> <span class="n">each_code</span> <span class="ow">in</span> <span class="n">dT20</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="n">srcs</span> <span class="o">=</span> <span class="n">dfCodes</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">each_code</span><span class="p">][[</span><span class="s2">&quot;source&quot;</span><span class="p">,</span> <span class="s2">&quot;source_two&quot;</span><span class="p">,</span> <span class="s2">&quot;source_three&quot;</span><span class="p">,</span> <span class="s2">&quot;description&quot;</span><span class="p">]]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">check_condition</span><span class="p">(</span><span class="n">srcs</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">conditions</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">conditions</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">dT20</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">each_code</span><span class="p">,</span> <span class="s2">&quot;Type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">a</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Industry&#39;</span><span class="p">:</span> <span class="s1">&#39;firebrick&#39;</span><span class="p">,</span> <span class="s1">&#39;Tobacco&#39;</span><span class="p">:</span> <span class="s1">&#39;darkslategrey&#39;</span><span class="p">,</span> <span class="s1">&#39;Food and drinks&#39;</span><span class="p">:</span> <span class="s1">&#39;navy&#39;</span><span class="p">,</span> <span class="s1">&#39;Plastic fragments and pieces&#39;</span><span class="p">:</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span>
         <span class="s1">&#39;Others&#39;</span><span class="p">:</span><span class="s1">&#39;linen&#39;</span><span class="p">,</span><span class="s1">&#39;Sanitary&#39;</span><span class="p">:</span><span class="s1">&#39;plum&#39;</span><span class="p">,</span><span class="s1">&#39;Packaging (non-food)&#39;</span><span class="p">:</span><span class="s1">&#39;saddlebrown&#39;</span><span class="p">}</span>
<span class="c1"># N = 3</span>
<span class="c1"># ind = np.arange(N)</span>
<span class="n">width</span> <span class="o">=</span> <span class="mf">0.6</span>

<span class="n">labels</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">colors</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">handles</span> <span class="o">=</span> <span class="p">[</span><span class="n">plt</span><span class="o">.</span><span class="n">Rectangle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">label</span><span class="p">])</span> <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

<span class="n">ax</span><span class="o">.</span><span class="n">barh</span><span class="p">(</span><span class="n">dT20</span><span class="o">.</span><span class="n">description</span><span class="p">,</span> <span class="n">dT20</span><span class="o">.</span><span class="n">quantity</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dT20</span><span class="o">.</span><span class="n">Type</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>  
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1000</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="s1">&#39;1,000&#39;</span><span class="p">])</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Total item count&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">labelpad</span> <span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">labelcolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">handles</span><span class="p">,</span> <span class="n">labels</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower right&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ha</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">legend_</span><span class="o">.</span><span class="n">legend_handles</span><span class="p">:</span>
    <span class="n">ha</span><span class="o">.</span><span class="n">set_edgecolor</span><span class="p">(</span><span class="s2">&quot;darkgrey&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;right&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;bottom&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;0.5&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="_images/6011de321f8070bbcb1d825844f0abd4177d2820b7c6a16c4c7f9604b3775e70.png" src="_images/6011de321f8070bbcb1d825844f0abd4177d2820b7c6a16c4c7f9604b3775e70.png" />
</div>
</div>
<div class="section" id="litter-items-of-local-origin">
<h4><span class="section-number">1.6.3.1. </span>Litter items of local origin<a class="headerlink" href="#litter-items-of-local-origin" title="Permalink to this headline">#</a></h4>
<p>Items that have four or more positive associations with a land use category.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlated</span> <span class="o">=</span> <span class="n">rho_at_buffer</span><span class="p">[(</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">exact_p</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">rho</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">local</span> <span class="o">=</span> <span class="n">correlated</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">local</span> <span class="o">=</span> <span class="n">local</span><span class="p">[</span><span class="n">local</span> <span class="o">&gt;=</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">local</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;correlations&quot;</span>
<span class="n">quantity</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">local</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">items_of_local_origin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">local</span><span class="p">,</span> <span class="n">quantity</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">items_of_local_origin</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>correlations</th>
      <th>quantity</th>
    </tr>
    <tr>
      <th>code</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>G27</th>
      <td>5</td>
      <td>744</td>
    </tr>
    <tr>
      <th>G30</th>
      <td>4</td>
      <td>325</td>
    </tr>
    <tr>
      <th>Gfoam</th>
      <td>4</td>
      <td>173</td>
    </tr>
    <tr>
      <th>G177</th>
      <td>4</td>
      <td>61</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="ubiquitous-items">
<h4><span class="section-number">1.6.3.2. </span>Ubiquitous items<a class="headerlink" href="#ubiquitous-items" title="Permalink to this headline">#</a></h4>
<p>Items that have three or less positive associations with a land use category and are positively associated with river or stream intersections.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlated</span> <span class="o">=</span> <span class="n">rho_at_buffer</span><span class="p">[(</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">exact_p</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">rho</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">pos_intersects</span> <span class="o">=</span> <span class="n">rho_at_buffer</span><span class="p">[(</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">use</span> <span class="o">==</span> <span class="s2">&quot;intersects&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">exact_p</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">)]</span>
<span class="n">correlated</span> <span class="o">=</span> <span class="n">correlated</span><span class="p">[</span><span class="n">correlated</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">pos_intersects</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">())]</span>
<span class="n">local</span> <span class="o">=</span> <span class="n">correlated</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">local</span> <span class="o">=</span> <span class="n">local</span><span class="p">[</span><span class="n">local</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">local</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;correlations&quot;</span>
<span class="n">quantity</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">local</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">items_of_local_origin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">local</span><span class="p">,</span> <span class="n">quantity</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">items_of_local_origin</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>correlations</th>
      <th>quantity</th>
    </tr>
    <tr>
      <th>code</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="other-items">
<h4><span class="section-number">1.6.3.3. </span>Other items<a class="headerlink" href="#other-items" title="Permalink to this headline">#</a></h4>
<p>Items that have three or less positive associations with a land use category and are NOT positively associated with river or stream intersections.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlated</span> <span class="o">=</span> <span class="n">rho_at_buffer</span><span class="p">[(</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">exact_p</span> <span class="o">&lt;=</span> <span class="mf">0.05</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">rho</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)]</span>
<span class="n">pos_intersects</span> <span class="o">=</span> <span class="n">rho_at_buffer</span><span class="p">[(</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">use</span> <span class="o">==</span> <span class="s2">&quot;intersects&quot;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">rho_at_buffer</span><span class="o">.</span><span class="n">exact_p</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">)]</span>
<span class="n">correlated</span> <span class="o">=</span> <span class="n">correlated</span><span class="p">[</span><span class="n">correlated</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">pos_intersects</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">())]</span>
<span class="n">local</span> <span class="o">=</span> <span class="n">correlated</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">local</span> <span class="o">=</span> <span class="n">local</span><span class="p">[</span><span class="n">local</span> <span class="o">&lt;=</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">local</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;correlations&quot;</span>
<span class="n">quantity</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">local</span><span class="o">.</span><span class="n">index</span><span class="p">)]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s2">&quot;code&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">quantity</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">items_of_local_origin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([</span><span class="n">local</span><span class="p">,</span> <span class="n">quantity</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
<span class="n">items_of_local_origin</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>correlations</th>
      <th>quantity</th>
    </tr>
    <tr>
      <th>code</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Gfrags</th>
      <td>2</td>
      <td>746</td>
    </tr>
    <tr>
      <th>G25</th>
      <td>2</td>
      <td>92</td>
    </tr>
    <tr>
      <th>G904</th>
      <td>2</td>
      <td>76</td>
    </tr>
    <tr>
      <th>G89</th>
      <td>1</td>
      <td>89</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<p>This script updated 16/04/2023 in Biel, CH</p>
<blockquote>
<div><p>❤️ what you do everyday</p>
</div></blockquote>
<p><em>analyst at hammerdirt</em></p>
</div>
</div>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Git repo: https://github.com/hammerdirt-analyst/landuse.git

Git branch: main

scipy     : 1.10.1
numpy     : 1.24.2
pandas    : 2.0.0
PIL       : 9.5.0
IPython   : 8.12.0
matplotlib: 3.7.1
seaborn   : 0.12.2
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="titlepage.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Assessing land-use influence on macrolitter abundance in freshwater systems</p>
      </div>
    </a>
    <a class="right-next"
       href="lac_leman.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2. </span>Lac Léman</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#esitmating-landuse">1.1. Esitmating landuse</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-road-and-river-network">1.1.1. Estimating the road and river network</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#map-of-survey-locations-and-aggregated-results">1.2. Map of survey locations and aggregated results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-a-collection-of-locations">1.3. <em>Ρ</em> for a collection of locations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#definition-of-codes-of-interest">1.3.1. Definition of codes of interest</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ranked-correlation-of-the-most-common-objects-on-bielersee">1.3.2. Ranked correlation of the most common objects on Bielersee</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#covariance-of-explanatory-variables">1.4. Covariance of explanatory variables</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#total-correlations-total-positive-correlations-and-total-negative-corrrelations">1.5. Total correlations, total positive correlations and total negative corrrelations</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sum-of-the-total-number-of-objects-with-a-correlation-positive-or-negative-collected-under-the-different-land-use-categories">1.5.1. Sum of the total number of objects with a correlation (positive or negative) collected under the different land use categories</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#the-objects-of-interest">1.6. The objects of interest</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-total-of-materials-of-the-objects-of-interest-with-respect-to-the-total-number-of-objects-collected">1.6.1. The % total of materials of the objects of interest with respect to the total number of objects collected.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-total-of-the-top-10-objects-with-respect-to-all-objects-collected">1.6.2. The % total of the top 10 objects with respect to all objects collected.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-cumulative-totals-of-the-top-20-objects-grouped-by-economic-source">1.6.3. The cumulative totals of the top 20 objects, grouped by economic source</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#litter-items-of-local-origin">1.6.3.1. Litter items of local origin</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#ubiquitous-items">1.6.3.2. Ubiquitous items</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#other-items">1.6.3.3. Other items</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Schreyer et all
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
   hammerdirt 2023
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>